<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ê–Ω–∞–ª–∏—Ç–∏–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Ñ–∞–π–ª–æ–≤ –∏ —Ç–æ–≤–∞—Ä–æ–≤</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            width: 100%;
            max-width: 1200px;
            margin: 0 auto;
            background-color: white;
            border-radius: 20px;
            box-shadow: 0 25px 50px rgba(0,0,0,0.15);
            overflow: hidden;
        }
        
        header {
            background: linear-gradient(90deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 40px 30px;
            text-align: center;
        }
        
        h1 {
            font-size: 2.8em;
            margin-bottom: 15px;
            font-weight: 700;
        }
        
        .subtitle {
            font-size: 1.2em;
            opacity: 0.9;
            font-weight: 300;
        }
        
        .content {
            padding: 40px 30px;
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 25px;
            margin-bottom: 40px;
        }
        
        .stats-card {
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            border-radius: 15px;
            padding: 30px;
            border: 2px solid #e0e0e0;
            box-shadow: 0 10px 30px rgba(0,0,0,0.08);
            transition: transform 0.3s, box-shadow 0.3s;
        }
        
        .stats-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 35px rgba(0,0,0,0.12);
        }
        
        .stats-card.main {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }
        
        .stats-card.main .stats-number {
            color: white;
        }
        
        .stats-card.main .stats-label,
        .stats-card.main .stats-icon {
            color: white;
        }
        
        .stats-icon {
            font-size: 3em;
            color: #667eea;
            margin-bottom: 20px;
        }
        
        .stats-label {
            font-size: 1.2em;
            color: #666;
            margin-bottom: 15px;
            font-weight: 500;
        }
        
        .stats-number {
            font-size: 4em;
            font-weight: 800;
            color: #667eea;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.1);
            margin: 15px 0;
        }
        
        .stats-unit {
            font-size: 1.3em;
            color: #666;
            font-weight: 500;
            margin-top: 10px;
        }
        
        .stats-subtitle {
            font-size: 0.9em;
            color: #888;
            margin-top: 10px;
            font-style: italic;
        }
        
        .info-panel {
            background: white;
            border-radius: 12px;
            padding: 25px;
            margin-bottom: 30px;
            border-left: 5px solid #667eea;
            box-shadow: 0 5px 15px rgba(0,0,0,0.05);
        }
        
        .info-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
        }
        
        .info-item {
            padding: 15px;
            background: #f8f9fa;
            border-radius: 8px;
            border-left: 4px solid #667eea;
        }
        
        .info-label {
            font-weight: 600;
            color: #555;
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 8px;
        }
        
        .info-value {
            color: #333;
            font-weight: 500;
            font-size: 1.1em;
        }
        
        .loading {
            text-align: center;
            padding: 60px 40px;
            font-size: 1.2em;
            color: #666;
            background: #f8f9fa;
            border-radius: 10px;
            margin: 20px 0;
        }
        
        .error {
            background-color: #ffe6e6;
            color: #cc0000;
            padding: 20px;
            border-radius: 10px;
            border-left: 5px solid #cc0000;
            margin: 20px 0;
        }
        
        .warning {
            background-color: #fff3cd;
            color: #856404;
            padding: 15px;
            border-radius: 8px;
            border-left: 5px solid #ffc107;
            margin: 20px 0;
        }
        
        .buttons {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin-top: 30px;
            flex-wrap: wrap;
        }
        
        .btn {
            background: linear-gradient(90deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 15px 35px;
            border-radius: 50px;
            font-size: 1.1em;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 10px;
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.3);
        }
        
        .btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(102, 126, 234, 0.4);
        }
        
        .btn:active {
            transform: translateY(-1px);
        }
        
        .btn-secondary {
            background: #6c757d;
            box-shadow: 0 5px 15px rgba(108, 117, 125, 0.3);
        }
        
        .btn-secondary:hover {
            box-shadow: 0 8px 20px rgba(108, 117, 125, 0.4);
        }
        
        .success-message {
            background-color: #d4edda;
            color: #155724;
            padding: 15px;
            border-radius: 8px;
            border-left: 5px solid #28a745;
            margin: 20px 0;
            display: none;
            animation: fadeIn 0.5s;
        }
        
        .status-badge {
            display: inline-flex;
            align-items: center;
            gap: 6px;
            padding: 6px 12px;
            border-radius: 20px;
            font-weight: 600;
            font-size: 0.85em;
        }
        
        .status-active {
            background-color: #d4edda;
            color: #155724;
        }
        
        .status-completed {
            background-color: #cce5ff;
            color: #004085;
        }
        
        .status-available {
            background-color: #d1ecf1;
            color: #0c5460;
        }
        
        .status-warning {
            background-color: #fff3cd;
            color: #856404;
        }
        
        .status-error {
            background-color: #f8d7da;
            color: #721c24;
        }
        
        .status-loading {
            background-color: #e2e3e5;
            color: #383d41;
        }
        
        footer {
            text-align: center;
            padding: 25px;
            color: #666;
            font-size: 0.9em;
            border-top: 1px solid #eee;
            background-color: #f8f9fa;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }
        
        .pulse {
            animation: pulse 2s infinite;
        }
        
        .progress-bar {
            height: 8px;
            background-color: #e9ecef;
            border-radius: 4px;
            margin: 15px 0;
            overflow: hidden;
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #667eea 0%, #764ba2 100%);
            border-radius: 4px;
            transition: width 0.5s ease-in-out;
        }
        
        .percentage {
            font-size: 1.2em;
            font-weight: 700;
            color: #667eea;
            margin-top: 5px;
        }
        
        @media (max-width: 768px) {
            .container {
                margin: 10px;
                border-radius: 15px;
            }
            
            header {
                padding: 30px 20px;
            }
            
            h1 {
                font-size: 2.2em;
            }
            
            .content {
                padding: 30px 20px;
            }
            
            .stats-number {
                font-size: 3em;
            }
            
            .stats-grid {
                grid-template-columns: 1fr;
            }
            
            .btn {
                padding: 12px 25px;
                font-size: 1em;
                width: 100%;
                justify-content: center;
            }
            
            .buttons {
                flex-direction: column;
            }
        }
        
        .last-update {
            font-size: 0.85em;
            color: #888;
            margin-top: 5px;
            font-style: italic;
        }
        
        .highlight {
            background-color: #fff3cd;
            padding: 3px 8px;
            border-radius: 4px;
            font-weight: 600;
        }
        
        .debug-info {
            background-color: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 8px;
            padding: 15px;
            margin-top: 20px;
            font-size: 0.85em;
            color: #6c757d;
            display: none;
        }
        
        .debug-toggle {
            cursor: pointer;
            color: #667eea;
            text-decoration: underline;
            font-size: 0.9em;
            margin-top: 10px;
            display: inline-block;
        }
        
        .emoji-info {
            background-color: #e3f2fd;
            border: 1px solid #bbdefb;
            border-radius: 8px;
            padding: 10px;
            margin: 10px 0;
            font-size: 0.9em;
        }
    </style>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</head>
<body>
    <div class="container">
        <header>
            <h1><i class="fas fa-chart-pie"></i> –ê–Ω–∞–ª–∏—Ç–∏–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏</h1>
            <div class="subtitle">–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Ñ–∞–π–ª–æ–≤ –∏ —Ç–æ–≤–∞—Ä–æ–≤ –ø–æ —Å—Ç–∞—Ç—É—Å–∞–º</div>
        </header>
        
        <div class="content">
            <div id="warningMessage" class="warning" style="display: none;">
                <i class="fas fa-exclamation-triangle"></i> –ò—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –¥–µ–º–æ-–¥–∞–Ω–Ω—ã–µ. –î–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ —Ä–µ–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –Ω–∞–∂–º–∏—Ç–µ "–û–±–Ω–æ–≤–∏—Ç—å".
            </div>
            
            <div id="successMessage" class="success-message">
                <i class="fas fa-check-circle"></i> –î–∞–Ω–Ω—ã–µ —É—Å–ø–µ—à–Ω–æ –æ–±–Ω–æ–≤–ª–µ–Ω—ã!
            </div>
            
            <div id="loading" class="loading">
                <i class="fas fa-spinner fa-spin fa-2x pulse"></i>
                <p style="margin-top: 15px;">–ê–Ω–∞–ª–∏–∑ –¥–∞–Ω–Ω—ã—Ö —Å –ª–∏—Å—Ç–∞ "–†–∞–±–æ—á–∏–µ –≥—Ä—É–ø–ø—ã"...</p>
                <p style="margin-top: 10px; font-size: 0.9em; color: #888;">
                    <i class="fas fa-info-circle"></i> –£—á–∏—Ç—ã–≤–∞—é—Ç—Å—è —ç–º–æ–¥–∂–∏ –≤ —Å—Ç–∞—Ç—É—Å–∞—Ö
                </p>
            </div>
            
            <div id="statsSection" style="display: none;">
                <div class="emoji-info">
                    <i class="fas fa-robot"></i> <strong>–ê–Ω–∞–ª–∏–∑ —Å —É—á–µ—Ç–æ–º —ç–º–æ–¥–∂–∏:</strong> 
                    "üÜï –î–æ—Å—Ç—É–ø–Ω–∞" ‚Üí –î–æ—Å—Ç—É–ø–Ω–æ, "‚úÖ –ó–∞–≤–µ—Ä—à–µ–Ω–∞" ‚Üí –í—ã–ø–æ–ª–Ω–µ–Ω–æ, "üîÑ –í —Ä–∞–±–æ—Ç–µ" ‚Üí –í —Ä–∞–±–æ—Ç–µ
                </div>
                
                <h2 style="color: #333; margin-bottom: 25px; text-align: center;">
                    <i class="fas fa-file-alt"></i> –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Ñ–∞–π–ª–æ–≤
                </h2>
                
                <div class="stats-grid">
                    <div class="stats-card main">
                        <div class="stats-icon">
                            <i class="fas fa-cloud-upload-alt"></i>
                        </div>
                        <div class="stats-label">–í—Å–µ–≥–æ —Ñ–∞–π–ª–æ–≤ –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏</div>
                        <div class="stats-number" id="totalFiles">0</div>
                        <div class="stats-unit">—Ñ–∞–π–ª–æ–≤</div>
                        <div class="progress-bar">
                            <div class="progress-fill" id="totalProgress" style="width: 100%"></div>
                        </div>
                        <div class="stats-subtitle">–í—Å–µ —Å—Ç—Ä–æ–∫–∏ –≤ —Ç–∞–±–ª–∏—Ü–µ</div>
                    </div>
                    
                    <div class="stats-card">
                        <div class="stats-icon">
                            <i class="fas fa-spinner"></i>
                        </div>
                        <div class="stats-label">–§–∞–π–ª–æ–≤ –≤ —Ä–∞–±–æ—Ç–µ</div>
                        <div class="stats-number" id="filesInProgress">0</div>
                        <div class="stats-unit">—Ñ–∞–π–ª–æ–≤</div>
                        <div class="progress-bar">
                            <div class="progress-fill" id="inProgressProgress" style="width: 0%"></div>
                        </div>
                        <div class="percentage" id="inProgressPercent">0%</div>
                        <div class="stats-subtitle">–°—Ç–∞—Ç—É—Å: üîÑ –í —Ä–∞–±–æ—Ç–µ</div>
                    </div>
                    
                    <div class="stats-card">
                        <div class="stats-icon">
                            <i class="fas fa-check-circle"></i>
                        </div>
                        <div class="stats-label">–§–∞–π–ª–æ–≤ –≤—ã–ø–æ–ª–Ω–µ–Ω–æ</div>
                        <div class="stats-number" id="filesCompleted">0</div>
                        <div class="stats-unit">—Ñ–∞–π–ª–æ–≤</div>
                        <div class="progress-bar">
                            <div class="progress-fill" id="completedProgress" style="width: 0%"></div>
                        </div>
                        <div class="percentage" id="completedPercent">0%</div>
                        <div class="stats-subtitle">–°—Ç–∞—Ç—É—Å: ‚úÖ –ó–∞–≤–µ—Ä—à–µ–Ω–∞</div>
                    </div>
                    
                    <div class="stats-card">
                        <div class="stats-icon">
                            <i class="fas fa-store"></i>
                        </div>
                        <div class="stats-label">–§–∞–π–ª–æ–≤ –¥–æ—Å—Ç—É–ø–Ω–æ</div>
                        <div class="stats-number" id="filesAvailable">0</div>
                        <div class="stats-unit">—Ñ–∞–π–ª–æ–≤</div>
                        <div class="progress-bar">
                            <div class="progress-fill" id="availableProgress" style="width: 0%"></div>
                        </div>
                        <div class="percentage" id="availablePercent">0%</div>
                        <div class="stats-subtitle">–°—Ç–∞—Ç—É—Å: üÜï –î–æ—Å—Ç—É–ø–Ω–∞</div>
                    </div>
                </div>
                
                <h2 style="color: #333; margin: 40px 0 25px; text-align: center;">
                    <i class="fas fa-boxes"></i> –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Ç–æ–≤–∞—Ä–æ–≤
                </h2>
                
                <div class="stats-grid">
                    <div class="stats-card main">
                        <div class="stats-icon">
                            <i class="fas fa-box-open"></i>
                        </div>
                        <div class="stats-label">–í—Å–µ–≥–æ —Ç–æ–≤–∞—Ä–æ–≤</div>
                        <div class="stats-number" id="totalProducts">0</div>
                        <div class="stats-unit">—Ç–æ–≤–∞—Ä–æ–≤</div>
                        <div class="progress-bar">
                            <div class="progress-fill" id="totalProductsProgress" style="width: 100%"></div>
                        </div>
                        <div class="stats-subtitle">–°—É–º–º–∞ –≤—Å–µ—Ö —Ç–æ–≤–∞—Ä–æ–≤</div>
                    </div>
                    
                    <div class="stats-card">
                        <div class="stats-icon">
                            <i class="fas fa-tools"></i>
                        </div>
                        <div class="stats-label">–¢–æ–≤–∞—Ä–æ–≤ –≤ —Ä–∞–±–æ—Ç–µ</div>
                        <div class="stats-number" id="productsInProgress">0</div>
                        <div class="stats-unit">—Ç–æ–≤–∞—Ä–æ–≤</div>
                        <div class="progress-bar">
                            <div class="progress-fill" id="productsInProgressProgress" style="width: 0%"></div>
                        </div>
                        <div class="percentage" id="productsInProgressPercent">0%</div>
                        <div class="stats-subtitle">–ò–∑ —Ñ–∞–π–ª–æ–≤ –≤ —Ä–∞–±–æ—Ç–µ</div>
                    </div>
                    
                    <div class="stats-card">
                        <div class="stats-icon">
                            <i class="fas fa-check-double"></i>
                        </div>
                        <div class="stats-label">–¢–æ–≤–∞—Ä–æ–≤ –≤—ã–ø–æ–ª–Ω–µ–Ω–æ</div>
                        <div class="stats-number" id="productsCompleted">0</div>
                        <div class="stats-unit">—Ç–æ–≤–∞—Ä–æ–≤</div>
                        <div class="progress-bar">
                            <div class="progress-fill" id="productsCompletedProgress" style="width: 0%"></div>
                        </div>
                        <div class="percentage" id="productsCompletedPercent">0%</div>
                        <div class="stats-subtitle">–ò–∑ –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤</div>
                    </div>
                    
                    <div class="stats-card">
                        <div class="stats-icon">
                            <i class="fas fa-store"></i>
                        </div>
                        <div class="stats-label">–¢–æ–≤–∞—Ä–æ–≤ –¥–æ—Å—Ç—É–ø–Ω–æ</div>
                        <div class="stats-number" id="productsAvailable">0</div>
                        <div class="stats-unit">—Ç–æ–≤–∞—Ä–æ–≤</div>
                        <div class="progress-bar">
                            <div class="progress-fill" id="productsAvailableProgress" style="width: 0%"></div>
                        </div>
                        <div class="percentage" id="productsAvailablePercent">0%</div>
                        <div class="stats-subtitle">–ò–∑ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤</div>
                    </div>
                </div>
                
                <div class="info-panel">
                    <h3 style="color: #333; margin-bottom: 20px;">
                        <i class="fas fa-info-circle"></i> –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ–± –∞–Ω–∞–ª–∏–∑–µ
                    </h3>
                    <div class="info-grid">
                        <div class="info-item">
                            <div class="info-label">
                                <i class="fas fa-database"></i> –ò—Å—Ç–æ—á–Ω–∏–∫ –¥–∞–Ω–Ω—ã—Ö
                            </div>
                            <div class="info-value">Google –¢–∞–±–ª–∏—Ü–∞</div>
                        </div>
                        <div class="info-item">
                            <div class="info-label">
                                <i class="fas fa-table"></i> –ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º—ã–π –ª–∏—Å—Ç
                            </div>
                            <div class="info-value">"–†–∞–±–æ—á–∏–µ –≥—Ä—É–ø–ø—ã"</div>
                        </div>
                        <div class="info-item">
                            <div class="info-label">
                                <i class="fas fa-filter"></i> –ê–Ω–∞–ª–∏–∑ —Å—Ç–∞—Ç—É—Å–æ–≤
                            </div>
                            <div class="info-value">–° —É—á–µ—Ç–æ–º —ç–º–æ–¥–∂–∏ ‚úÖüîÑüÜï</div>
                        </div>
                        <div class="info-item">
                            <div class="info-label">
                                <i class="fas fa-calculator"></i> –ü–æ–¥—Å—á–µ—Ç —Ç–æ–≤–∞—Ä–æ–≤
                            </div>
                            <div class="info-value">–°—Ç–æ–ª–±–µ—Ü: "–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç–æ–≤–∞—Ä–æ–≤"</div>
                        </div>
                    </div>
                    
                    <div style="margin-top: 20px; padding-top: 20px; border-top: 1px solid #eee;">
                        <div class="info-item" style="background: none; padding: 10px 0; border-left: none;">
                            <div class="info-label">
                                <i class="fas fa-chart-line"></i> –°–æ—Å—Ç–æ—è–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã
                            </div>
                            <div class="info-value">
                                <span id="tableStatus" class="status-badge status-loading">
                                    <i class="fas fa-spinner fa-spin"></i> –ó–∞–≥—Ä—É–∑–∫–∞...
                                </span>
                            </div>
                        </div>
                        <div class="info-item" style="background: none; padding: 10px 0; border-left: none;">
                            <div class="info-label">
                                <i class="fas fa-clock"></i> –ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ
                            </div>
                            <div class="info-value" id="lastUpdate">-</div>
                        </div>
                        <div class="info-item" style="background: none; padding: 10px 0; border-left: none;">
                            <div class="info-label">
                                <i class="fas fa-code"></i> –†–µ–∂–∏–º –æ—Ç–ª–∞–¥–∫–∏
                            </div>
                            <div class="info-value">
                                <span class="debug-toggle" onclick="toggleDebug()">–ü–æ–∫–∞–∑–∞—Ç—å –æ—Ç–ª–∞–¥–æ—á–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é</span>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div id="debugInfo" class="debug-info">
                    <h4><i class="fas fa-bug"></i> –û—Ç–ª–∞–¥–æ—á–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</h4>
                    <div id="debugContent">
                        –ó–∞–≥—Ä—É–∑–∏—Ç–µ –¥–∞–Ω–Ω—ã–µ –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –æ—Ç–ª–∞–¥–æ—á–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏...
                    </div>
                </div>
                
                <div id="errorSection" style="display: none;"></div>
                
                <div class="buttons">
                    <button onclick="loadData(true)" class="btn">
                        <i class="fas fa-sync-alt"></i> –û–±–Ω–æ–≤–∏—Ç—å –¥–∞–Ω–Ω—ã–µ
                    </button>
                    <button onclick="showDetailedReport()" class="btn btn-secondary">
                        <i class="fas fa-file-alt"></i> –ü–æ–¥—Ä–æ–±–Ω—ã–π –æ—Ç—á–µ—Ç
                    </button>
                </div>
                
                <div class="last-update" id="autoUpdateInfo" style="text-align: center; margin-top: 20px;">
                    –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–∞–∂–¥—ã–µ 5 –º–∏–Ω—É—Ç
                </div>
            </div>
        </div>
        
        <footer>
            <p><i class="fas fa-chart-bar"></i> –°–∏—Å—Ç–µ–º–∞ –∞–Ω–∞–ª–∏—Ç–∏–∫–∏ –∑–∞–≥—Ä—É–∑–∫–∏ —Ñ–∞–π–ª–æ–≤ –∏ —Ç–æ–≤–∞—Ä–æ–≤</p>
            <p style="margin-top: 5px; font-size: 0.8em;">
                –ê–Ω–∞–ª–∏–∑ –¥–∞–Ω–Ω—ã—Ö –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏ –Ω–∞ –æ—Å–Ω–æ–≤–µ –ª–∏—Å—Ç–∞ "–†–∞–±–æ—á–∏–µ –≥—Ä—É–ø–ø—ã"
            </p>
        </footer>
    </div>

    <script>
        // ID –≤–∞—à–µ–π Google –¢–∞–±–ª–∏—Ü—ã
        const SPREADSHEET_ID = '120MzlbbGmHqroutPw5EtvfkTdDf4RMGbf72CV_K7IeE';
        // ID –ª–∏—Å—Ç–∞ "–†–∞–±–æ—á–∏–µ –≥—Ä—É–ø–ø—ã" (gid –∏–∑ —Å—Å—ã–ª–∫–∏)
        const SHEET_GID = '1272115114';
        // –ù–∞–∑–≤–∞–Ω–∏–µ –ª–∏—Å—Ç–∞ –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è
        const SHEET_NAME = '–†–∞–±–æ—á–∏–µ –≥—Ä—É–ø–ø—ã';
        
        // –ù–∞–∑–≤–∞–Ω–∏—è —Å—Ç–æ–ª–±—Ü–æ–≤ –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ (–≤–æ–∑–º–æ–∂–Ω—ã–µ –≤–∞—Ä–∏–∞–Ω—Ç—ã)
        const STATUS_COLUMN_NAMES = ['–°—Ç–∞—Ç—É—Å –≥—Ä—É–ø–ø—ã', '–°—Ç–∞—Ç—É—Å', '–°—Ç–∞—Ç—É—Å —Ñ–∞–π–ª–∞', '–°–æ—Å—Ç–æ—è–Ω–∏–µ'];
        const PRODUCTS_COLUMN_NAMES = ['–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç–æ–≤–∞—Ä–æ–≤', '–¢–æ–≤–∞—Ä—ã', '–ö–æ–ª-–≤–æ —Ç–æ–≤–∞—Ä–æ–≤', '–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ'];
        
        // –≠–º–æ–¥–∂–∏ –¥–ª—è —Å—Ç–∞—Ç—É—Å–æ–≤
        const EMOJI_STATUSES = {
            'üÜï': 'available',     // –î–æ—Å—Ç—É–ø–Ω–∞
            '‚úÖ': 'completed',     // –ó–∞–≤–µ—Ä—à–µ–Ω–∞
            'üîÑ': 'in_progress'    // –í —Ä–∞–±–æ—Ç–µ
        };
        
        // –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–ª—è –¥–∞–Ω–Ω—ã—Ö
        let allData = [];
        let tableHeaders = [];
        let isDemoData = false;
        let lastUpdateTime = null;
        
        // –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
        let stats = {
            totalFiles: 0,
            filesInProgress: 0,
            filesCompleted: 0,
            filesAvailable: 0,
            totalProducts: 0,
            productsInProgress: 0,
            productsCompleted: 0,
            productsAvailable: 0
        };
        
        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –∏ –∞–Ω–∞–ª–∏–∑–∞ –¥–∞–Ω–Ω—ã—Ö
        async function loadData(forceLoad = false) {
            const loading = document.getElementById('loading');
            const statsSection = document.getElementById('statsSection');
            const errorSection = document.getElementById('errorSection');
            const warningMessage = document.getElementById('warningMessage');
            const successMessage = document.getElementById('successMessage');
            const tableStatus = document.getElementById('tableStatus');
            const debugContent = document.getElementById('debugContent');
            
            // –ï—Å–ª–∏ —É–∂–µ –∑–∞–≥—Ä—É–∂–µ–Ω—ã –¥–µ–º–æ-–¥–∞–Ω–Ω—ã–µ –∏ –Ω–µ –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞
            if (isDemoData && !forceLoad) {
                warningMessage.style.display = 'block';
                successMessage.style.display = 'none';
                return;
            }
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –∑–∞–≥—Ä—É–∑–∫–∏
            loading.style.display = 'block';
            statsSection.style.display = 'none';
            errorSection.style.display = 'none';
            warningMessage.style.display = 'none';
            successMessage.style.display = 'none';
            errorSection.innerHTML = '';
            
            // –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∞—Ç—É—Å
            tableStatus.className = 'status-badge status-loading';
            tableStatus.innerHTML = '<i class="fas fa-spinner fa-spin"></i> –ê–Ω–∞–ª–∏–∑ –¥–∞–Ω–Ω—ã—Ö...';
            
            try {
                console.log(`–ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö —Å –ª–∏—Å—Ç–∞ "${SHEET_NAME}"...`);
                
                // –ò—Å–ø–æ–ª—å–∑—É–µ–º gid –¥–ª—è —É–∫–∞–∑–∞–Ω–∏—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –ª–∏—Å—Ç–∞
                const csvUrl = `https://docs.google.com/spreadsheets/d/${SPREADSHEET_ID}/export?format=csv&gid=${SHEET_GID}`;
                
                // –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π URL
                const altCsvUrl = `https://docs.google.com/spreadsheets/d/${SPREADSHEET_ID}/gviz/tq?tqx=out:csv&gid=${SHEET_GID}`;
                
                let response;
                
                // –ü—Ä–æ–±—É–µ–º –ø–µ—Ä–≤—ã–π –º–µ—Ç–æ–¥
                try {
                    console.log('–ü—Ä–æ–±—É–µ–º –º–µ—Ç–æ–¥ 1...');
                    response = await fetch(csvUrl);
                    if (!response.ok) {
                        console.log('–ú–µ—Ç–æ–¥ 1 –Ω–µ —Å—Ä–∞–±–æ—Ç–∞–ª, –ø—Ä–æ–±—É–µ–º –º–µ—Ç–æ–¥ 2...');
                        throw new Error(`–ú–µ—Ç–æ–¥ 1: ${response.status}`);
                    }
                } catch (error) {
                    console.log('–ü—Ä–æ–±—É–µ–º –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π –º–µ—Ç–æ–¥...');
                    response = await fetch(altCsvUrl);
                    if (!response.ok) {
                        throw new Error(`–ú–µ—Ç–æ–¥ 2: ${response.status}`);
                    }
                }
                
                if (!response.ok) {
                    throw new Error(`–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏: ${response.status} ${response.statusText}`);
                }
                
                const csvText = await response.text();
                
                // –ü–∞—Ä—Å–∏–º CSV
                const rows = csvText.split('\n').filter(row => row.trim() !== '');
                
                if (rows.length === 0) {
                    throw new Error('–¢–∞–±–ª–∏—Ü–∞ –ø—É—Å—Ç–∞');
                }
                
                console.log(`–ó–∞–≥—Ä—É–∂–µ–Ω–æ ${rows.length} —Å—Ç—Ä–æ–∫`);
                
                // –ü–∞—Ä—Å–∏–º –∑–∞–≥–æ–ª–æ–≤–∫–∏ (–ø–µ—Ä–≤–∞—è —Å—Ç—Ä–æ–∫–∞)
                tableHeaders = parseCSVRow(rows[0]);
                
                // –ù–∞—Ö–æ–¥–∏–º –∏–Ω–¥–µ–∫—Å—ã –Ω—É–∂–Ω—ã—Ö —Å—Ç–æ–ª–±—Ü–æ–≤
                const statusColumnIndex = findColumnIndex(STATUS_COLUMN_NAMES);
                const productsColumnIndex = findColumnIndex(PRODUCTS_COLUMN_NAMES);
                
                console.log('–ù–∞–π–¥–µ–Ω–Ω—ã–µ –∏–Ω–¥–µ–∫—Å—ã:', {
                    status: statusColumnIndex,
                    products: productsColumnIndex,
                    headers: tableHeaders
                });
                
                // –°–±—Ä–∞—Å—ã–≤–∞–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
                resetStats();
                
                // –ü–∞—Ä—Å–∏–º –¥–∞–Ω–Ω—ã–µ –∏ –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º
                allData = [];
                let debugInfo = [];
                
                for (let i = 1; i < rows.length; i++) {
                    const rowData = parseCSVRow(rows[i]);
                    if (rowData.length > 0 && rowData.some(cell => cell && cell.trim() !== '')) {
                        allData.push(rowData);
                        
                        // –ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º —Å—Ç—Ä–æ–∫—É
                        const rowAnalysis = analyzeRowWithEmoji(rowData, statusColumnIndex, productsColumnIndex, i);
                        debugInfo.push(rowAnalysis);
                    }
                }
                
                isDemoData = false;
                
                // –û–±–Ω–æ–≤–ª—è–µ–º –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ
                updateDisplay();
                
                // –û–±–Ω–æ–≤–ª—è–µ–º –æ—Ç–ª–∞–¥–æ—á–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é
                debugContent.innerHTML = `
                    <strong>–ó–∞–≥–æ–ª–æ–≤–∫–∏ —Ç–∞–±–ª–∏—Ü—ã:</strong><br>
                    ${tableHeaders.map((h, i) => `${i}: "${h}"`).join(', ')}<br><br>
                    
                    <strong>–ù–∞–π–¥–µ–Ω–Ω—ã–µ —Å—Ç–æ–ª–±—Ü—ã:</strong><br>
                    ‚Ä¢ –°—Ç–∞—Ç—É—Å: ${statusColumnIndex !== -1 ? `—Å—Ç–æ–ª–±–µ—Ü ${statusColumnIndex} ("${tableHeaders[statusColumnIndex]}")` : '–Ω–µ –Ω–∞–π–¥–µ–Ω'}<br>
                    ‚Ä¢ –¢–æ–≤–∞—Ä—ã: ${productsColumnIndex !== -1 ? `—Å—Ç–æ–ª–±–µ—Ü ${productsColumnIndex} ("${tableHeaders[productsColumnIndex]}")` : '–Ω–µ –Ω–∞–π–¥–µ–Ω'}<br><br>
                    
                    <strong>–û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–æ–≤ –ø–æ —ç–º–æ–¥–∂–∏:</strong><br>
                    ‚Ä¢ üÜï ‚Üí –î–æ—Å—Ç—É–ø–Ω–æ<br>
                    ‚Ä¢ ‚úÖ ‚Üí –í—ã–ø–æ–ª–Ω–µ–Ω–æ<br>
                    ‚Ä¢ üîÑ ‚Üí –í —Ä–∞–±–æ—Ç–µ<br><br>
                    
                    <strong>–ê–Ω–∞–ª–∏–∑ —Å—Ç—Ä–æ–∫ (–ø–µ—Ä–≤—ã–µ 10):</strong><br>
                    ${debugInfo.slice(0, 10).map(info => info.text).join('<br>')}
                    ${debugInfo.length > 10 ? `<br>... –∏ –µ—â–µ ${debugInfo.length - 10} —Å—Ç—Ä–æ–∫` : ''}<br><br>
                    
                    <strong>–ò—Ç–æ–≥–æ–≤–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:</strong><br>
                    ‚Ä¢ –í—Å–µ–≥–æ —Å—Ç—Ä–æ–∫: ${stats.totalFiles}<br>
                    ‚Ä¢ –í —Ä–∞–±–æ—Ç–µ: ${stats.filesInProgress}<br>
                    ‚Ä¢ –í—ã–ø–æ–ª–Ω–µ–Ω–æ: ${stats.filesCompleted}<br>
                    ‚Ä¢ –î–æ—Å—Ç—É–ø–Ω–æ: ${stats.filesAvailable}<br>
                    ‚Ä¢ –í—Å–µ–≥–æ —Ç–æ–≤–∞—Ä–æ–≤: ${stats.totalProducts}
                `;
                
                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
                loading.style.display = 'none';
                statsSection.style.display = 'block';
                
                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ –æ–± —É—Å–ø–µ—Ö–µ
                successMessage.textContent = `‚úÖ –ê–Ω–∞–ª–∏–∑ –¥–∞–Ω–Ω—ã—Ö –∑–∞–≤–µ—Ä—à–µ–Ω! –û–±—Ä–∞–±–æ—Ç–∞–Ω–æ ${stats.totalFiles} —Ñ–∞–π–ª–æ–≤.`;
                successMessage.style.display = 'block';
                setTimeout(() => {
                    successMessage.style.display = 'none';
                }, 3000);
                
                // –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º –∞–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ
                setupAutoRefresh();
                
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö:', error);
                
                // –ï—Å–ª–∏ –Ω–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å –¥–∞–Ω–Ω—ã–µ, –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –¥–µ–º–æ-–¥–∞–Ω–Ω—ã–µ
                loading.style.display = 'none';
                
                if (stats.totalFiles === 0 || forceLoad) {
                    showDemoData();
                    warningMessage.style.display = 'block';
                    warningMessage.innerHTML = `<i class="fas fa-exclamation-triangle"></i> –ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å –¥–∞–Ω–Ω—ã–µ. –ü–æ–∫–∞–∑–∞–Ω—ã –¥–µ–º–æ-–¥–∞–Ω–Ω—ã–µ.`;
                } else {
                    // –ï—Å–ª–∏ —É–∂–µ –µ—Å—Ç—å –¥–∞–Ω–Ω—ã–µ, –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –∏—Ö
                    statsSection.style.display = 'block';
                    tableStatus.className = 'status-badge status-warning';
                    tableStatus.innerHTML = '<i class="fas fa-exclamation-triangle"></i> –ö—ç—à–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ';
                    updateLastUpdateTime();
                }
                
                errorSection.style.display = 'block';
                errorSection.innerHTML = `
                    <div class="error">
                        <h3><i class="fas fa-exclamation-triangle"></i> –û—à–∏–±–∫–∞ –∞–Ω–∞–ª–∏–∑–∞ –¥–∞–Ω–Ω—ã—Ö</h3>
                        <p><strong>${error.message}</strong></p>
                        <p>–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤ —Ç–∞–±–ª–∏—Ü–µ –µ—Å—Ç—å –Ω—É–∂–Ω—ã–µ —Å—Ç–æ–ª–±—Ü—ã</p>
                        <div style="margin-top: 15px;">
                            <button onclick="loadData(true)" class="btn" style="font-size: 0.9em; padding: 10px 20px;">
                                <i class="fas fa-redo"></i> –ü–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å —Å–Ω–æ–≤–∞
                            </button>
                            <button onclick="showDemoData()" class="btn btn-secondary" style="font-size: 0.9em; padding: 10px 20px; margin-left: 10px;">
                                <i class="fas fa-eye"></i> –î–µ–º–æ-—Ä–µ–∂–∏–º
                            </button>
                        </div>
                    </div>
                `;
            }
        }
        
        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–æ–∏—Å–∫–∞ –∏–Ω–¥–µ–∫—Å–∞ —Å—Ç–æ–ª–±—Ü–∞ –ø–æ —Å–ø–∏—Å–∫—É –≤–æ–∑–º–æ–∂–Ω—ã—Ö –Ω–∞–∑–≤–∞–Ω–∏–π
        function findColumnIndex(columnNames) {
            for (const columnName of columnNames) {
                // –ò—â–µ–º —Ç–æ—á–Ω–æ–µ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ
                let index = tableHeaders.findIndex(header => 
                    header && header.trim().toLowerCase() === columnName.toLowerCase()
                );
                
                // –ï—Å–ª–∏ –Ω–µ –Ω–∞—à–ª–∏ —Ç–æ—á–Ω–æ–≥–æ —Å–æ–≤–ø–∞–¥–µ–Ω–∏—è, –∏—â–µ–º —á–∞—Å—Ç–∏—á–Ω–æ–µ
                if (index === -1) {
                    index = tableHeaders.findIndex(header => 
                        header && header.toLowerCase().includes(columnName.toLowerCase())
                    );
                }
                
                // –ï—Å–ª–∏ –Ω–∞—à–ª–∏, –≤–æ–∑–≤—Ä–∞—â–∞–µ–º –∏–Ω–¥–µ–∫—Å
                if (index !== -1) {
                    return index;
                }
            }
            
            return -1;
        }
        
        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ —Å—Ç—Ä–æ–∫–∏ –¥–∞–Ω–Ω—ã—Ö —Å —É—á–µ—Ç–æ–º —ç–º–æ–¥–∂–∏
        function analyzeRowWithEmoji(rowData, statusIndex, productsIndex, rowNumber) {
            // –£–≤–µ–ª–∏—á–∏–≤–∞–µ–º —Å—á–µ—Ç—á–∏–∫ —Ñ–∞–π–ª–æ–≤
            stats.totalFiles++;
            
            // –ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º —Å—Ç–∞—Ç—É—Å
            let status = '';
            let statusType = 'unknown';
            let emoji = '';
            
            if (statusIndex !== -1 && rowData[statusIndex]) {
                status = rowData[statusIndex].trim();
                
                // –û–ø—Ä–µ–¥–µ–ª—è–µ–º —Å—Ç–∞—Ç—É—Å –ø–æ —ç–º–æ–¥–∂–∏
                emoji = getFirstEmoji(status);
                
                if (emoji === 'üÜï') {
                    statusType = 'available';
                } else if (emoji === '‚úÖ') {
                    statusType = 'completed';
                } else if (emoji === 'üîÑ') {
                    statusType = 'in_progress';
                } else {
                    // –ï—Å–ª–∏ –Ω–µ—Ç —ç–º–æ–¥–∂–∏, –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º —Ç–µ–∫—Å—Ç
                    const statusLower = status.toLowerCase();
                    if (statusLower.includes('–∑–∞–≤–µ—Ä—à') || statusLower.includes('–≤—ã–ø–æ–ª–Ω')) {
                        statusType = 'completed';
                    } else if (statusLower.includes('–¥–æ—Å—Ç—É–ø')) {
                        statusType = 'available';
                    } else if (statusLower.includes('—Ä–∞–±–æ—Ç')) {
                        statusType = 'in_progress';
                    }
                }
            }
            
            // –ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç–æ–≤–∞—Ä–æ–≤
            let productsCount = 0;
            if (productsIndex !== -1 && rowData[productsIndex]) {
                const productsStr = rowData[productsIndex].trim();
                // –£–±–∏—Ä–∞–µ–º –≤—Å–µ –Ω–µ—Ü–∏—Ñ—Ä–æ–≤—ã–µ —Å–∏–º–≤–æ–ª—ã, –∫—Ä–æ–º–µ —Ç–æ—á–∫–∏ –∏ –∑–∞–ø—è—Ç–æ–π
                const cleanedStr = productsStr.replace(/[^\d.,]/g, '');
                // –ó–∞–º–µ–Ω—è–µ–º –∑–∞–ø—è—Ç—É—é –Ω–∞ —Ç–æ—á–∫—É –¥–ª—è –ø–∞—Ä—Å–∏–Ω–≥–∞
                const normalizedStr = cleanedStr.replace(',', '.');
                productsCount = parseFloat(normalizedStr) || 0;
            }
            
            // –î–æ–±–∞–≤–ª—è–µ–º —Ç–æ–≤–∞—Ä—ã –∫ –æ–±—â–µ–º—É –∫–æ–ª–∏—á–µ—Å—Ç–≤—É
            stats.totalProducts += productsCount;
            
            // –†–∞—Å–ø—Ä–µ–¥–µ–ª—è–µ–º –ø–æ —Å—Ç–∞—Ç—É—Å–∞–º
            switch(statusType) {
                case 'completed':
                    stats.filesCompleted++;
                    stats.productsCompleted += productsCount;
                    break;
                    
                case 'available':
                    stats.filesAvailable++;
                    stats.productsAvailable += productsCount;
                    break;
                    
                case 'in_progress':
                    stats.filesInProgress++;
                    stats.productsInProgress += productsCount;
                    break;
                    
                default:
                    // –ï—Å–ª–∏ —Å—Ç–∞—Ç—É—Å –Ω–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω, —Å—á–∏—Ç–∞–µ–º –∫–∞–∫ "–≤ —Ä–∞–±–æ—Ç–µ"
                    stats.filesInProgress++;
                    stats.productsInProgress += productsCount;
            }
            
            // –í–æ–∑–≤—Ä–∞—â–∞–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏
            return {
                text: `–°—Ç—Ä–æ–∫–∞ ${rowNumber}: "${status}" (—ç–º–æ–¥–∂–∏: ${emoji || '–Ω–µ—Ç'}) ‚Üí ${statusType}, —Ç–æ–≤–∞—Ä–æ–≤=${productsCount}`,
                status: status,
                emoji: emoji,
                products: productsCount,
                statusType: statusType
            };
        }
        
        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –ø–µ—Ä–≤–æ–≥–æ —ç–º–æ–¥–∂–∏ –∏–∑ —Å—Ç—Ä–æ–∫–∏
        function getFirstEmoji(text) {
            if (!text) return '';
            
            // –†–µ–≥—É–ª—è—Ä–Ω–æ–µ –≤—ã—Ä–∞–∂–µ–Ω–∏–µ –¥–ª—è –ø–æ–∏—Å–∫–∞ —ç–º–æ–¥–∂–∏
            const emojiRegex = /[\p{Emoji}]/u;
            const match = text.match(emojiRegex);
            
            if (match && match[0] in EMOJI_STATUSES) {
                return match[0];
            }
            
            return '';
        }
        
        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è —Å–±—Ä–æ—Å–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
        function resetStats() {
            stats = {
                totalFiles: 0,
                filesInProgress: 0,
                filesCompleted: 0,
                filesAvailable: 0,
                totalProducts: 0,
                productsInProgress: 0,
                productsCompleted: 0,
                productsAvailable: 0
            };
        }
        
        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è
        function updateDisplay() {
            // –û–±–Ω–æ–≤–ª—è–µ–º –æ—Å–Ω–æ–≤–Ω—ã–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏ —Ñ–∞–π–ª–æ–≤
            document.getElementById('totalFiles').textContent = stats.totalFiles;
            document.getElementById('filesInProgress').textContent = stats.filesInProgress;
            document.getElementById('filesCompleted').textContent = stats.filesCompleted;
            document.getElementById('filesAvailable').textContent = stats.filesAvailable;
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –æ—Å–Ω–æ–≤–Ω—ã–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏ —Ç–æ–≤–∞—Ä–æ–≤
            document.getElementById('totalProducts').textContent = stats.totalProducts;
            document.getElementById('productsInProgress').textContent = stats.productsInProgress;
            document.getElementById('productsCompleted').textContent = stats.productsCompleted;
            document.getElementById('productsAvailable').textContent = stats.productsAvailable;
            
            // –†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ–º –ø—Ä–æ—Ü–µ–Ω—Ç—ã –¥–ª—è —Ñ–∞–π–ª–æ–≤
            const inProgressPercent = stats.totalFiles > 0 ? Math.round((stats.filesInProgress / stats.totalFiles) * 100) : 0;
            const completedPercent = stats.totalFiles > 0 ? Math.round((stats.filesCompleted / stats.totalFiles) * 100) : 0;
            const availablePercent = stats.totalFiles > 0 ? Math.round((stats.filesAvailable / stats.totalFiles) * 100) : 0;
            
            // –†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ–º –ø—Ä–æ—Ü–µ–Ω—Ç—ã –¥–ª—è —Ç–æ–≤–∞—Ä–æ–≤
            const productsInProgressPercent = stats.totalProducts > 0 ? Math.round((stats.productsInProgress / stats.totalProducts) * 100) : 0;
            const productsCompletedPercent = stats.totalProducts > 0 ? Math.round((stats.productsCompleted / stats.totalProducts) * 100) : 0;
            const productsAvailablePercent = stats.totalProducts > 0 ? Math.round((stats.productsAvailable / stats.totalProducts) * 100) : 0;
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –ø—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä—ã –∏ –ø—Ä–æ—Ü–µ–Ω—Ç—ã –¥–ª—è —Ñ–∞–π–ª–æ–≤
            document.getElementById('inProgressProgress').style.width = `${inProgressPercent}%`;
            document.getElementById('inProgressPercent').textContent = `${inProgressPercent}%`;
            
            document.getElementById('completedProgress').style.width = `${completedPercent}%`;
            document.getElementById('completedPercent').textContent = `${completedPercent}%`;
            
            document.getElementById('availableProgress').style.width = `${availablePercent}%`;
            document.getElementById('availablePercent').textContent = `${availablePercent}%`;
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –ø—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä—ã –∏ –ø—Ä–æ—Ü–µ–Ω—Ç—ã –¥–ª—è —Ç–æ–≤–∞—Ä–æ–≤
            document.getElementById('productsInProgressProgress').style.width = `${productsInProgressPercent}%`;
            document.getElementById('productsInProgressPercent').textContent = `${productsInProgressPercent}%`;
            
            document.getElementById('productsCompletedProgress').style.width = `${productsCompletedPercent}%`;
            document.getElementById('productsCompletedPercent').textContent = `${productsCompletedPercent}%`;
            
            document.getElementById('productsAvailableProgress').style.width = `${productsAvailablePercent}%`;
            document.getElementById('productsAvailablePercent').textContent = `${productsAvailablePercent}%`;
            
            // –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∞—Ç—É—Å
            const tableStatus = document.getElementById('tableStatus');
            if (isDemoData) {
                tableStatus.className = 'status-badge status-warning';
                tableStatus.innerHTML = '<i class="fas fa-exclamation-triangle"></i> –î–µ–º–æ-–¥–∞–Ω–Ω—ã–µ';
            } else {
                tableStatus.className = 'status-badge status-active';
                tableStatus.innerHTML = '<i class="fas fa-check-circle"></i> –ê–∫—Ç—É–∞–ª—å–Ω–æ';
            }
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –≤—Ä–µ–º—è –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
            updateLastUpdateTime();
            
            // –ê–Ω–∏–º–∞—Ü–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
            animateNumbers();
        }
        
        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –≤—Ä–µ–º–µ–Ω–∏ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
        function updateLastUpdateTime() {
            lastUpdateTime = new Date();
            document.getElementById('lastUpdate').textContent = lastUpdateTime.toLocaleString('ru-RU');
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ–± –∞–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏
            const nextUpdate = new Date(lastUpdateTime.getTime() + 5 * 60 * 1000);
            document.getElementById('autoUpdateInfo').textContent = 
                `–°–ª–µ–¥—É—é—â–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ: ${nextUpdate.getHours().toString().padStart(2, '0')}:${nextUpdate.getMinutes().toString().padStart(2, '0')}`;
        }
        
        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –∞–Ω–∏–º–∞—Ü–∏–∏ —á–∏—Å–µ–ª
        function animateNumbers() {
            const numbers = document.querySelectorAll('.stats-number');
            numbers.forEach(number => {
                number.classList.add('pulse');
                setTimeout(() => {
                    number.classList.remove('pulse');
                }, 1000);
            });
        }
        
        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–æ–∫–∞–∑–∞ –¥–µ–º–æ-–¥–∞–Ω–Ω—ã—Ö
        function showDemoData() {
            const loading = document.getElementById('loading');
            const statsSection = document.getElementById('statsSection');
            const errorSection = document.getElementById('errorSection');
            const warningMessage = document.getElementById('warningMessage');
            
            // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º –¥–µ–º–æ-—Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ä–µ–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
            resetStats();
            
            // –î–µ–º–æ-–¥–∞–Ω–Ω—ã–µ: 1 –≤ —Ä–∞–±–æ—Ç–µ, 2 –≤—ã–ø–æ–ª–Ω–µ–Ω–æ, –æ—Å—Ç–∞–ª—å–Ω—ã–µ –¥–æ—Å—Ç—É–ø–Ω–æ
            stats.totalFiles = 8;
            stats.filesInProgress = 1;    // –í —Ä–∞–±–æ—Ç–µ
            stats.filesCompleted = 2;     // –í—ã–ø–æ–ª–Ω–µ–Ω–æ
            stats.filesAvailable = stats.totalFiles - stats.filesInProgress - stats.filesCompleted; // –î–æ—Å—Ç—É–ø–Ω–æ
            
            stats.totalProducts = 150;
            stats.productsInProgress = 20;    // –¢–æ–≤–∞—Ä—ã –≤ —Ä–∞–±–æ—Ç–µ
            stats.productsCompleted = 60;     // –¢–æ–≤–∞—Ä—ã –≤—ã–ø–æ–ª–Ω–µ–Ω–æ
            stats.productsAvailable = stats.totalProducts - stats.productsInProgress - stats.productsCompleted; // –¢–æ–≤–∞—Ä—ã –¥–æ—Å—Ç—É–ø–Ω–æ
            
            isDemoData = true;
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ
            updateDisplay();
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
            loading.style.display = 'none';
            statsSection.style.display = 'block';
            errorSection.style.display = 'none';
            warningMessage.style.display = 'block';
            warningMessage.innerHTML = `<i class="fas fa-exclamation-triangle"></i> –ò—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –¥–µ–º–æ-–¥–∞–Ω–Ω—ã–µ. –î–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ —Ä–µ–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –Ω–∞–∂–º–∏—Ç–µ "–û–±–Ω–æ–≤–∏—Ç—å".`;
        }
        
        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–æ–∫–∞–∑–∞ –ø–æ–¥—Ä–æ–±–Ω–æ–≥–æ –æ—Ç—á–µ—Ç–∞
        function showDetailedReport() {
            const report = `
üìä **–î–ï–¢–ê–õ–¨–ù–´–ô –û–¢–ß–ï–¢ –ü–û –ê–ù–ê–õ–ò–ó–£ –î–ê–ù–ù–´–•**

**–ò–°–¢–û–ß–ù–ò–ö –î–ê–ù–ù–´–•:**
‚Ä¢ –õ–∏—Å—Ç —Ç–∞–±–ª–∏—Ü—ã: "${SHEET_NAME}"
‚Ä¢ –í—Å–µ–≥–æ —Å—Ç—Ä–æ–∫: ${stats.totalFiles}
‚Ä¢ –í—Ä–µ–º—è –∞–Ω–∞–ª–∏–∑–∞: ${lastUpdateTime ? lastUpdateTime.toLocaleString('ru-RU') : '–ù–µ –ø—Ä–æ–≤–µ–¥–µ–Ω'}

**–°–¢–ê–¢–ò–°–¢–ò–ö–ê –§–ê–ô–õ–û–í:**
‚Ä¢ –í—Å–µ–≥–æ —Ñ–∞–π–ª–æ–≤: ${stats.totalFiles}
‚Ä¢ –§–∞–π–ª–æ–≤ –≤ —Ä–∞–±–æ—Ç–µ: ${stats.filesInProgress} (${stats.totalFiles > 0 ? Math.round((stats.filesInProgress / stats.totalFiles) * 100) : 0}%)
‚Ä¢ –§–∞–π–ª–æ–≤ –≤—ã–ø–æ–ª–Ω–µ–Ω–æ: ${stats.filesCompleted} (${stats.totalFiles > 0 ? Math.round((stats.filesCompleted / stats.totalFiles) * 100) : 0}%)
‚Ä¢ –§–∞–π–ª–æ–≤ –¥–æ—Å—Ç—É–ø–Ω–æ: ${stats.filesAvailable} (${stats.totalFiles > 0 ? Math.round((stats.filesAvailable / stats.totalFiles) * 100) : 0}%)

**–°–¢–ê–¢–ò–°–¢–ò–ö–ê –¢–û–í–ê–†–û–í:**
‚Ä¢ –í—Å–µ–≥–æ —Ç–æ–≤–∞—Ä–æ–≤: ${stats.totalProducts}
‚Ä¢ –¢–æ–≤–∞—Ä–æ–≤ –≤ —Ä–∞–±–æ—Ç–µ: ${stats.productsInProgress} (${stats.totalProducts > 0 ? Math.round((stats.productsInProgress / stats.totalProducts) * 100) : 0}%)
‚Ä¢ –¢–æ–≤–∞—Ä–æ–≤ –≤—ã–ø–æ–ª–Ω–µ–Ω–æ: ${stats.productsCompleted} (${stats.totalProducts > 0 ? Math.round((stats.productsCompleted / stats.totalProducts) * 100) : 0}%)
‚Ä¢ –¢–æ–≤–∞—Ä–æ–≤ –¥–æ—Å—Ç—É–ø–Ω–æ: ${stats.productsAvailable} (${stats.totalProducts > 0 ? Math.round((stats.productsAvailable / stats.totalProducts) * 100) : 0}%)

**–ê–ù–ê–õ–ò–ó –ü–û –°–¢–û–õ–ë–¶–ê–ú:**
‚Ä¢ –ê–Ω–∞–ª–∏–∑ —Å—Ç–∞—Ç—É—Å–æ–≤: "${STATUS_COLUMN_NAMES[0]}" (—Å —É—á–µ—Ç–æ–º —ç–º–æ–¥–∂–∏)
‚Ä¢ –ü–æ–¥—Å—á–µ—Ç —Ç–æ–≤–∞—Ä–æ–≤: "${PRODUCTS_COLUMN_NAMES[0]}"

**–†–ê–°–ü–û–ó–ù–ê–í–ê–ù–ò–ï –≠–ú–û–î–ñ–ò:**
‚Ä¢ üÜï ‚Üí –î–æ—Å—Ç—É–ø–Ω–æ
‚Ä¢ ‚úÖ ‚Üí –í—ã–ø–æ–ª–Ω–µ–Ω–æ
‚Ä¢ üîÑ ‚Üí –í —Ä–∞–±–æ—Ç–µ

**–†–ï–ñ–ò–ú –î–ê–ù–ù–´–•:** ${isDemoData ? '–î–µ–º–æ-–¥–∞–Ω–Ω—ã–µ ‚ö†Ô∏è' : '–†–µ–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ ‚úÖ'}
            `;
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –æ—Ç—á–µ—Ç –≤ –º–æ–¥–∞–ª—å–Ω–æ–º –æ–∫–Ω–µ
            alert(report);
        }
        
        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è –æ—Ç–ª–∞–¥–æ—á–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏
        function toggleDebug() {
            const debugInfo = document.getElementById('debugInfo');
            const toggleBtn = document.querySelector('.debug-toggle');
            
            if (debugInfo.style.display === 'block') {
                debugInfo.style.display = 'none';
                toggleBtn.textContent = '–ü–æ–∫–∞–∑–∞—Ç—å –æ—Ç–ª–∞–¥–æ—á–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é';
            } else {
                debugInfo.style.display = 'block';
                toggleBtn.textContent = '–°–∫—Ä—ã—Ç—å –æ—Ç–ª–∞–¥–æ—á–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é';
            }
        }
        
        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∞–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
        function setupAutoRefresh() {
            // –û—á–∏—â–∞–µ–º –ø—Ä–µ–¥—ã–¥—É—â–∏–π –∏–Ω—Ç–µ—Ä–≤–∞–ª
            if (window.refreshInterval) {
                clearInterval(window.refreshInterval);
            }
            
            // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –Ω–æ–≤—ã–π –∏–Ω—Ç–µ—Ä–≤–∞–ª (5 –º–∏–Ω—É—Ç)
            window.refreshInterval = setInterval(() => {
                console.log('–ê–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö...');
                loadData(true);
            }, 5 * 60 * 1000);
        }
        
        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–∞—Ä—Å–∏–Ω–≥–∞ CSV —Å—Ç—Ä–æ–∫–∏
        function parseCSVRow(row) {
            const result = [];
            let current = '';
            let inQuotes = false;
            
            for (let i = 0; i < row.length; i++) {
                const char = row[i];
                const nextChar = row[i + 1];
                
                if (char === '"') {
                    if (inQuotes && nextChar === '"') {
                        current += '"';
                        i++; // –ü—Ä–æ–ø—É—Å–∫–∞–µ–º —Å–ª–µ–¥—É—é—â–∏–π —Å–∏–º–≤–æ–ª
                    } else {
                        inQuotes = !inQuotes;
                    }
                } else if (char === ',' && !inQuotes) {
                    result.push(current);
                    current = '';
                } else {
                    current += char;
                }
            }
            
            result.push(current);
            return result.map(cell => cell.trim());
        }
        
        // –ó–∞–≥—Ä—É–∂–∞–µ–º –¥–∞–Ω–Ω—ã–µ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        document.addEventListener('DOMContentLoaded', function() {
            loadData();
        });
        
        // –û–±–Ω–æ–≤–ª—è–µ–º –¥–∞–Ω–Ω—ã–µ –ø—Ä–∏ –≤–∏–¥–∏–º–æ—Å—Ç–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        document.addEventListener('visibilitychange', function() {
            if (!document.hidden && !isDemoData) {
                loadData(true);
            }
        });
    </script>
</body>
</html>
