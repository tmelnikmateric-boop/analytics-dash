<script>
        // ID Google –¢–∞–±–ª–∏—Ü
        const MANAGER_SPREADSHEET_ID = '120MzlbbGmHqroutPw5EtvfkTdDf4RMGbf72CV_K7IeE';
        const MANAGER_SHEET_GID = '1272115114';
        
        // –î–ª—è –ø—É–±–ª–∏—á–Ω–æ–π —Ç–∞–±–ª–∏—Ü—ã –∫–æ–Ω—Ç–µ–Ω—Ç–∞ –∏—Å–ø–æ–ª—å–∑—É–µ–º Sheet ID –∏–∑ URL
        const CONTENT_SPREADSHEET_ID = '2PACX-1vT2AYh3Iqgf07HInfdc3bQwE_L3AweAonhdE7LlJlJtBHo_5rx3WVko0Pdm5eGjCvmcjTOWja8nP20O';
        
        // –ù–∞–∑–≤–∞–Ω–∏—è —Å—Ç–æ–ª–±—Ü–æ–≤ –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞
        const STATUS_COLUMN_NAMES = ['–°—Ç–∞—Ç—É—Å –≥—Ä—É–ø–ø—ã', '–°—Ç–∞—Ç—É—Å', '–°—Ç–∞—Ç—É—Å —Ñ–∞–π–ª–∞', '–°–æ—Å—Ç–æ—è–Ω–∏–µ'];
        const PRODUCTS_COLUMN_NAMES = ['–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç–æ–≤–∞—Ä–æ–≤', '–¢–æ–≤–∞—Ä—ã', '–ö–æ–ª-–≤–æ —Ç–æ–≤–∞—Ä–æ–≤', '–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ'];
        const FILENAME_COLUMN_NAMES = ['–ò–º—è —Ñ–∞–π–ª–∞', '–§–∞–π–ª', '–ù–∞–∑–≤–∞–Ω–∏–µ —Ñ–∞–π–ª–∞', 'File name'];
        const COMPLETION_DATE_COLUMN_NAMES = ['–î–∞—Ç–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è —Ä–∞–±–æ—Ç—ã', '–î–∞—Ç–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è', '–î–∞—Ç–∞ –æ–∫–æ–Ω—á–∞–Ω–∏—è', 'Completion date'];
        const ADDITION_DATE_COLUMN_NAMES = ['–î–∞—Ç–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è —Ñ–∞–π–ª–∞', '–î–∞—Ç–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è', '–î–∞—Ç–∞ –∑–∞–≥—Ä—É–∑–∫–∏', 'Upload date', '–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è'];
        const URGENCY_COLUMN_NAMES = ['–°—Ä–æ—á–Ω–æ—Å—Ç—å', '–°—Ä–æ—á–Ω–æ', '–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç', 'Urgency'];
        
        // –≠–º–æ–¥–∂–∏ –¥–ª—è —Å—Ç–∞—Ç—É—Å–æ–≤
        const EMOJI_STATUSES = {
            'üÜï': 'available',     // –î–æ—Å—Ç—É–ø–Ω–∞
            '‚úÖ': 'completed',     // –ó–∞–≤–µ—Ä—à–µ–Ω–∞
            'üîÑ': 'in_progress'    // –í —Ä–∞–±–æ—Ç–µ
        };
        
        // –†—É—Å—Å–∫–∏–µ –Ω–∞–∑–≤–∞–Ω–∏—è –º–µ—Å—è—Ü–µ–≤
        const MONTH_NAMES_RU = ['–Ø–Ω–≤–∞—Ä—å', '–§–µ–≤—Ä–∞–ª—å', '–ú–∞—Ä—Ç', '–ê–ø—Ä–µ–ª—å', '–ú–∞–π', '–ò—é–Ω—å',
                               '–ò—é–ª—å', '–ê–≤–≥—É—Å—Ç', '–°–µ–Ω—Ç—è–±—Ä—å', '–û–∫—Ç—è–±—Ä—å', '–ù–æ—è–±—Ä—å', '–î–µ–∫–∞–±—Ä—å'];
        
        // –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–ª—è –¥–∞–Ω–Ω—ã—Ö
        let isDemoData = false;
        let monthlyChart = null;
        
        // –û—Å–Ω–æ–≤–Ω—ã–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏
        let managerProductsToAdd = 0;
        let contentProductsToAdd = 0;
        let productsAddedThisMonth = 0;
        
        // –ú–∞—Å—Å–∏–≤—ã –¥–ª—è —Ñ–∞–π–ª–æ–≤ (–±–µ–∑ –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã—Ö)
        let managerFilesForProcessing = [];
        let contentFilesForProcessing = [];
        
        // –î–∞–Ω–Ω—ã–µ –¥–ª—è –≥—Ä–∞—Ñ–∏–∫–∞ (–æ–±—ä–µ–¥–∏–Ω–µ–Ω–Ω—ã–µ –∏–∑ –¥–≤—É—Ö –ª–∏—Å—Ç–æ–≤)
        let monthlyData = [];
        
        // –¢–µ–∫—É—â–∏–π –º–µ—Å—è—Ü –∏ –≥–æ–¥
        let currentMonth, currentYear;
        
        // –§—É–Ω–∫—Ü–∏–∏ –¥–ª—è –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞
        function openRulesModal() {
            document.getElementById('rulesModal').style.display = 'flex';
            document.body.style.overflow = 'hidden'; // –ë–ª–æ–∫–∏—Ä—É–µ–º —Å–∫—Ä–æ–ª–ª —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        }
        
        function closeRulesModal() {
            document.getElementById('rulesModal').style.display = 'none';
            document.body.style.overflow = 'auto'; // –†–∞–∑–±–ª–æ–∫–∏—Ä—É–µ–º —Å–∫—Ä–æ–ª–ª —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        }
        
        // –ó–∞–∫—Ä—ã—Ç–∏–µ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ –ø–æ –∫–ª–∏–∫—É –Ω–∞ overlay
        document.getElementById('rulesModal').addEventListener('click', function(e) {
            if (e.target === this) {
                closeRulesModal();
            }
        });
        
        // –ó–∞–∫—Ä—ã—Ç–∏–µ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ –ø–æ –∫–ª–∞–≤–∏—à–µ Escape
        document.addEventListener('keydown', function(e) {
            if (e.key === 'Escape') {
                closeRulesModal();
            }
        });
        
        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –∏ –∞–Ω–∞–ª–∏–∑–∞ –¥–∞–Ω–Ω—ã—Ö –∏–∑ –æ–±–µ–∏—Ö —Ç–∞–±–ª–∏—Ü
        async function loadData(forceLoad = false) {
            const loading = document.getElementById('loading');
            const statsSection = document.getElementById('statsSection');
            
            loading.style.display = 'block';
            statsSection.style.display = 'none';
            
            try {
                // –°–±—Ä–∞—Å—ã–≤–∞–µ–º –¥–∞–Ω–Ω—ã–µ
                managerProductsToAdd = 0;
                contentProductsToAdd = 0;
                productsAddedThisMonth = 0;
                managerFilesForProcessing = [];
                contentFilesForProcessing = [];
                monthlyData = [];
                
                // –û–ø—Ä–µ–¥–µ–ª—è–µ–º —Ç–µ–∫—É—â–∏–π –º–µ—Å—è—Ü –∏ –≥–æ–¥
                const currentDate = new Date();
                currentMonth = currentDate.getMonth(); // 0-11
                currentYear = currentDate.getFullYear();
                
                // –û–±—ä–µ–∫—Ç –¥–ª—è —Å–±–æ—Ä–∞ –¥–∞–Ω–Ω—ã—Ö –ø–æ –º–µ—Å—è—Ü–∞–º (–æ–±—ä–µ–¥–∏–Ω–µ–Ω–Ω—ã—Ö)
                const monthlyTotals = {};
                
                // –ó–∞–≥—Ä—É–∂–∞–µ–º –¥–∞–Ω–Ω—ã–µ –∏–∑ —Ç–∞–±–ª–∏—Ü—ã –º–µ–Ω–µ–¥–∂–µ—Ä–æ–≤
                await loadManagerData(monthlyTotals);
                
                // –ó–∞–≥—Ä—É–∂–∞–µ–º –¥–∞–Ω–Ω—ã–µ –∏–∑ —Ç–∞–±–ª–∏—Ü—ã –∫–æ–Ω—Ç–µ–Ω—Ç–∞
                await loadContentData(monthlyTotals);
                
                // –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ–º –¥–∞–Ω–Ω—ã–µ –ø–æ –º–µ—Å—è—Ü–∞–º –≤ –º–∞—Å—Å–∏–≤ –¥–ª—è –≥—Ä–∞—Ñ–∏–∫–∞
                monthlyData = Object.keys(monthlyTotals)
                    .map(monthKey => ({
                        month: monthKey,
                        total: monthlyTotals[monthKey]
                    }))
                    .sort((a, b) => {
                        // –°–æ—Ä—Ç–∏—Ä—É–µ–º –ø–æ –¥–∞—Ç–µ (—Ñ–æ—Ä–º–∞—Ç "–Ø–Ω–≤–∞—Ä—å 2024")
                        const parseMonth = (str) => {
                            const [monthStr, yearStr] = str.split(' ');
                            const monthIndex = MONTH_NAMES_RU.indexOf(monthStr);
                            const year = parseInt(yearStr);
                            return new Date(year, monthIndex);
                        };
                        return parseMonth(a.month) - parseMonth(b.month);
                    });
                
                isDemoData = false;
                updateDisplay();
                
                loading.style.display = 'none';
                statsSection.style.display = 'block';
                
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö:', error);
                loading.style.display = 'none';
                showDemoData();
            }
        }
        
        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö –∏–∑ —Ç–∞–±–ª–∏—Ü—ã –º–µ–Ω–µ–¥–∂–µ—Ä–æ–≤
        async function loadManagerData(monthlyTotals) {
            try {
                console.log('–ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –º–µ–Ω–µ–¥–∂–µ—Ä–æ–≤...');
                const csvUrl = `https://docs.google.com/spreadsheets/d/${MANAGER_SPREADSHEET_ID}/export?format=csv&gid=${MANAGER_SHEET_GID}`;
                const altCsvUrl = `https://docs.google.com/spreadsheets/d/${MANAGER_SPREADSHEET_ID}/gviz/tq?tqx=out:csv&gid=${MANAGER_SHEET_GID}`;
                
                let response;
                
                try {
                    response = await fetch(csvUrl);
                    if (!response.ok) throw new Error(`–ú–µ—Ç–æ–¥ 1: ${response.status}`);
                } catch (error) {
                    console.log('–ü–æ–ø—ã—Ç–∫–∞ –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–æ–≥–æ –º–µ—Ç–æ–¥–∞ –∑–∞–≥—Ä—É–∑–∫–∏...');
                    response = await fetch(altCsvUrl);
                    if (!response.ok) throw new Error(`–ú–µ—Ç–æ–¥ 2: ${response.status}`);
                }
                
                const csvText = await response.text();
                console.log('CSV –¥–∞–Ω–Ω—ã–µ –º–µ–Ω–µ–¥–∂–µ—Ä–æ–≤ –∑–∞–≥—Ä—É–∂–µ–Ω—ã, –¥–ª–∏–Ω–∞:', csvText.length);
                const rows = csvText.split('\n').filter(row => row.trim() !== '');
                
                if (rows.length === 0) throw new Error('–¢–∞–±–ª–∏—Ü–∞ –º–µ–Ω–µ–¥–∂–µ—Ä–æ–≤ –ø—É—Å—Ç–∞');
                
                // –ü–∞—Ä—Å–∏–º –∑–∞–≥–æ–ª–æ–≤–∫–∏
                const tableHeaders = parseCSVRow(rows[0]);
                console.log('–ó–∞–≥–æ–ª–æ–≤–∫–∏ –º–µ–Ω–µ–¥–∂–µ—Ä–æ–≤:', tableHeaders);
                
                // –ù–∞—Ö–æ–¥–∏–º –∏–Ω–¥–µ–∫—Å—ã –Ω—É–∂–Ω—ã—Ö —Å—Ç–æ–ª–±—Ü–æ–≤
                const statusColumnIndex = findColumnIndex(tableHeaders, STATUS_COLUMN_NAMES);
                const productsColumnIndex = findColumnIndex(tableHeaders, PRODUCTS_COLUMN_NAMES);
                const filenameColumnIndex = findColumnIndex(tableHeaders, FILENAME_COLUMN_NAMES);
                const completionDateColumnIndex = findColumnIndex(tableHeaders, COMPLETION_DATE_COLUMN_NAMES);
                const additionDateColumnIndex = findColumnIndex(tableHeaders, ADDITION_DATE_COLUMN_NAMES);
                const urgencyColumnIndex = findColumnIndex(tableHeaders, URGENCY_COLUMN_NAMES);
                
                console.log('–ò–Ω–¥–µ–∫—Å—ã —Å—Ç–æ–ª–±—Ü–æ–≤ –º–µ–Ω–µ–¥–∂–µ—Ä–æ–≤:', {
                    statusColumnIndex,
                    productsColumnIndex,
                    filenameColumnIndex,
                    completionDateColumnIndex,
                    additionDateColumnIndex,
                    urgencyColumnIndex
                });
                
                // –ü–∞—Ä—Å–∏–º –∏ –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º –¥–∞–Ω–Ω—ã–µ
                for (let i = 1; i < rows.length; i++) {
                    const rowData = parseCSVRow(rows[i]);
                    if (rowData.length === 0 || !rowData.some(cell => cell && cell.trim() !== '')) continue;
                    
                    // –ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º —Å—Ç—Ä–æ–∫—É
                    const analysis = analyzeRow(rowData, statusColumnIndex, productsColumnIndex, 
                                               filenameColumnIndex, completionDateColumnIndex, 
                                               additionDateColumnIndex, urgencyColumnIndex, i);
                    
                    // –î–æ–±–∞–≤–ª—è–µ–º –≤ –º–∞—Å—Å–∏–≤ —Ñ–∞–π–ª–æ–≤ –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏, –µ—Å–ª–∏ –Ω–µ "–∑–∞–≤–µ—Ä—à–µ–Ω–æ"
                    if (analysis.statusType !== 'completed' && analysis.filename) {
                        managerFilesForProcessing.push({
                            filename: analysis.filename,
                            productsCount: analysis.productsCount,
                            status: analysis.status,
                            statusType: analysis.statusType,
                            additionDate: analysis.additionDateFormatted,
                            additionDateOriginal: analysis.additionDateOriginal,
                            urgency: analysis.urgency,
                            urgencyClass: getUrgencyClass(analysis.urgency),
                            rowIndex: i
                        });
                    }
                    
                    // –°—á–∏—Ç–∞–µ–º —Ç–æ–≤–∞—Ä—ã –¥–ª—è –≤–µ—Ä—Ö–Ω–∏—Ö –ø–æ–∫–∞–∑–∞—Ç–µ–ª–µ–π
                    if (analysis.statusType === 'completed') {
                        // –°—á–∏—Ç–∞–µ–º —Ç–æ–≤–∞—Ä—ã –∑–∞–≤–µ—Ä—à–µ–Ω–Ω—ã–µ –≤ —Ç–µ–∫—É—â–µ–º –º–µ—Å—è—Ü–µ
                        if (analysis.isCurrentMonth) {
                            productsAddedThisMonth += analysis.productsCount;
                        }
                        
                        // –î–æ–±–∞–≤–ª—è–µ–º –≤ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –ø–æ –º–µ—Å—è—Ü–∞–º –¥–ª—è –≥—Ä–∞—Ñ–∏–∫–∞
                        if (analysis.completionMonth) {
                            if (!monthlyTotals[analysis.completionMonth]) {
                                monthlyTotals[analysis.completionMonth] = 0;
                            }
                            monthlyTotals[analysis.completionMonth] += analysis.productsCount;
                        }
                    } else {
                        managerProductsToAdd += analysis.productsCount;
                    }
                }
                
                console.log('–î–∞–Ω–Ω—ã–µ –º–µ–Ω–µ–¥–∂–µ—Ä–æ–≤ –∑–∞–≥—Ä—É–∂–µ–Ω—ã:', {
                    filesCount: managerFilesForProcessing.length,
                    productsToAdd: managerProductsToAdd
                });
                
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö –º–µ–Ω–µ–¥–∂–µ—Ä–æ–≤:', error);
                throw error;
            }
        }
        
        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö –∏–∑ —Ç–∞–±–ª–∏—Ü—ã –∫–æ–Ω—Ç–µ–Ω—Ç–∞
        async function loadContentData(monthlyTotals) {
            try {
                console.log('–ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –∫–æ–Ω—Ç–µ–Ω—Ç–∞...');
                
                // –î–ª—è –ø—É–±–ª–∏—á–Ω—ã—Ö —Ç–∞–±–ª–∏—Ü Google Sheets –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å CSV —ç–∫—Å–ø–æ—Ä—Ç
                // –§–æ—Ä–º–∞—Ç URL: https://docs.google.com/spreadsheets/d/e/{ID}/pub?output=csv
                const csvUrl = `https://docs.google.com/spreadsheets/d/e/${CONTENT_SPREADSHEET_ID}/pub?output=csv`;
                
                const response = await fetch(csvUrl);
                if (!response.ok) throw new Error(`–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏: ${response.status}`);
                
                const csvText = await response.text();
                console.log('CSV –¥–∞–Ω–Ω—ã–µ –∫–æ–Ω—Ç–µ–Ω—Ç–∞ –∑–∞–≥—Ä—É–∂–µ–Ω—ã, –¥–ª–∏–Ω–∞:', csvText.length);
                
                const rows = csvText.split('\n').filter(row => row.trim() !== '');
                
                if (rows.length < 2) {
                    console.log('–¢–∞–±–ª–∏—Ü–∞ –∫–æ–Ω—Ç–µ–Ω—Ç–∞ –ø—É—Å—Ç–∞ –∏–ª–∏ –∏–º–µ–µ—Ç –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Å—Ç—Ä–æ–∫');
                    return;
                }
                
                // –ü–∞—Ä—Å–∏–º –∑–∞–≥–æ–ª–æ–≤–∫–∏
                const tableHeaders = parseCSVRow(rows[0]);
                console.log('–ó–∞–≥–æ–ª–æ–≤–∫–∏ –∫–æ–Ω—Ç–µ–Ω—Ç–∞:', tableHeaders);
                
                // –ù–∞—Ö–æ–¥–∏–º –∏–Ω–¥–µ–∫—Å—ã –Ω—É–∂–Ω—ã—Ö —Å—Ç–æ–ª–±—Ü–æ–≤
                const statusColumnIndex = findColumnIndex(tableHeaders, STATUS_COLUMN_NAMES);
                const productsColumnIndex = findColumnIndex(tableHeaders, PRODUCTS_COLUMN_NAMES);
                const filenameColumnIndex = findColumnIndex(tableHeaders, FILENAME_COLUMN_NAMES);
                const completionDateColumnIndex = findColumnIndex(tableHeaders, COMPLETION_DATE_COLUMN_NAMES);
                const additionDateColumnIndex = findColumnIndex(tableHeaders, ADDITION_DATE_COLUMN_NAMES);
                const urgencyColumnIndex = findColumnIndex(tableHeaders, URGENCY_COLUMN_NAMES);
                
                console.log('–ò–Ω–¥–µ–∫—Å—ã —Å—Ç–æ–ª–±—Ü–æ–≤ –∫–æ–Ω—Ç–µ–Ω—Ç–∞:', {
                    statusColumnIndex,
                    productsColumnIndex,
                    filenameColumnIndex,
                    completionDateColumnIndex,
                    additionDateColumnIndex,
                    urgencyColumnIndex
                });
                
                // –ü–∞—Ä—Å–∏–º –∏ –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º –¥–∞–Ω–Ω—ã–µ
                for (let i = 1; i < rows.length; i++) {
                    const rowData = parseCSVRow(rows[i]);
                    if (rowData.length === 0 || !rowData.some(cell => cell && cell.trim() !== '')) continue;
                    
                    // –ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º —Å—Ç—Ä–æ–∫—É
                    const analysis = analyzeRow(rowData, statusColumnIndex, productsColumnIndex, 
                                               filenameColumnIndex, completionDateColumnIndex, 
                                               additionDateColumnIndex, urgencyColumnIndex, i);
                    
                    // –î–æ–±–∞–≤–ª—è–µ–º –≤ –º–∞—Å—Å–∏–≤ —Ñ–∞–π–ª–æ–≤ –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏, –µ—Å–ª–∏ –Ω–µ "–∑–∞–≤–µ—Ä—à–µ–Ω–æ"
                    if (analysis.statusType !== 'completed' && analysis.filename) {
                        contentFilesForProcessing.push({
                            filename: analysis.filename,
                            productsCount: analysis.productsCount,
                            status: analysis.status,
                            statusType: analysis.statusType,
                            additionDate: analysis.additionDateFormatted,
                            additionDateOriginal: analysis.additionDateOriginal,
                            urgency: analysis.urgency,
                            urgencyClass: getUrgencyClass(analysis.urgency),
                            rowIndex: i
                        });
                    }
                    
                    // –°—á–∏—Ç–∞–µ–º —Ç–æ–≤–∞—Ä—ã –¥–ª—è –≤–µ—Ä—Ö–Ω–∏—Ö –ø–æ–∫–∞–∑–∞—Ç–µ–ª–µ–π
                    if (analysis.statusType === 'completed') {
                        // –°—á–∏—Ç–∞–µ–º —Ç–æ–≤–∞—Ä—ã –∑–∞–≤–µ—Ä—à–µ–Ω–Ω—ã–µ –≤ —Ç–µ–∫—É—â–µ–º –º–µ—Å—è—Ü–µ
                        if (analysis.isCurrentMonth) {
                            productsAddedThisMonth += analysis.productsCount;
                        }
                        
                        // –î–æ–±–∞–≤–ª—è–µ–º –≤ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –ø–æ –º–µ—Å—è—Ü–∞–º –¥–ª—è –≥—Ä–∞—Ñ–∏–∫–∞
                        if (analysis.completionMonth) {
                            if (!monthlyTotals[analysis.completionMonth]) {
                                monthlyTotals[analysis.completionMonth] = 0;
                            }
                            monthlyTotals[analysis.completionMonth] += analysis.productsCount;
                        }
                    } else {
                        contentProductsToAdd += analysis.productsCount;
                    }
                }
                
                console.log('–î–∞–Ω–Ω—ã–µ –∫–æ–Ω—Ç–µ–Ω—Ç–∞ –∑–∞–≥—Ä—É–∂–µ–Ω—ã:', {
                    filesCount: contentFilesForProcessing.length,
                    productsToAdd: contentProductsToAdd
                });
                
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö –∫–æ–Ω—Ç–µ–Ω—Ç–∞:', error);
                // –ù–µ –ø—Ä–µ—Ä—ã–≤–∞–µ–º –∑–∞–≥—Ä—É–∑–∫—É, –ø—Ä–æ–¥–æ–ª–∂–∞–µ–º —Å –¥–∞–Ω–Ω—ã–º–∏ –º–µ–Ω–µ–¥–∂–µ—Ä–æ–≤
                // –ü—Ä–æ—Å—Ç–æ –ª–æ–≥–∏—Ä—É–µ–º –æ—à–∏–±–∫—É –∏ –ø—Ä–æ–¥–æ–ª–∂–∞–µ–º
            }
        }
        
        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ —Å—Ç—Ä–æ–∫–∏
        function analyzeRow(rowData, statusIndex, productsIndex, filenameIndex, 
                           completionDateIndex, additionDateIndex, urgencyIndex, rowNumber) {
            let status = '';
            let statusType = 'unknown';
            let productsCount = 0;
            let filename = '';
            let completionDate = null;
            let completionMonth = null;
            let dateStr = '';
            let additionDateOriginal = '';
            let additionDateFormatted = '';
            let urgency = '';
            let isCurrentMonth = false;
            
            // –ü–æ–ª—É—á–∞–µ–º —Å—Ç–∞—Ç—É—Å
            if (statusIndex !== -1 && rowData[statusIndex]) {
                status = rowData[statusIndex].trim();
                statusType = determineStatusType(status);
            }
            
            // –ü–æ–ª—É—á–∞–µ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç–æ–≤–∞—Ä–æ–≤
            if (productsIndex !== -1 && rowData[productsIndex]) {
                const productsStr = rowData[productsIndex].trim();
                const cleanedStr = productsStr.replace(/[^\d.,]/g, '');
                const normalizedStr = cleanedStr.replace(',', '.');
                productsCount = parseFloat(normalizedStr) || 0;
            }
            
            // –ü–æ–ª—É—á–∞–µ–º –∏–º—è —Ñ–∞–π–ª–∞
            if (filenameIndex !== -1 && rowData[filenameIndex]) {
                filename = rowData[filenameIndex].trim();
            }
            
            // –ü–æ–ª—É—á–∞–µ–º –¥–∞—Ç—É –¥–æ–±–∞–≤–ª–µ–Ω–∏—è —Ñ–∞–π–ª–∞
            if (additionDateIndex !== -1 && rowData[additionDateIndex]) {
                additionDateOriginal = rowData[additionDateIndex].trim();
                additionDateFormatted = formatDate(additionDateOriginal);
            }
            
            // –ü–æ–ª—É—á–∞–µ–º —Å—Ä–æ—á–Ω–æ—Å—Ç—å
            if (urgencyIndex !== -1 && rowData[urgencyIndex]) {
                urgency = rowData[urgencyIndex].trim();
            }
            
            // –ü–æ–ª—É—á–∞–µ–º –¥–∞—Ç—É –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è
            if (completionDateIndex !== -1 && rowData[completionDateIndex]) {
                dateStr = rowData[completionDateIndex].trim();
                if (dateStr) {
                    try {
                        // –§–æ—Ä–º–∞—Ç: "01.12.2025 16:14:34"
                        // –£–¥–∞–ª—è–µ–º –≤—Ä–µ–º—è, –æ—Å—Ç–∞–≤–ª—è–µ–º —Ç–æ–ª—å–∫–æ –¥–∞—Ç—É
                        const dateOnly = dateStr.split(' ')[0]; // "01.12.2025"
                        
                        // –ü–∞—Ä—Å–∏–º DD.MM.YYYY
                        const parts = dateOnly.split('.');
                        if (parts.length === 3) {
                            const day = parseInt(parts[0], 10);
                            const month = parseInt(parts[1], 10) - 1; // –ú–µ—Å—è—Ü—ã 0-11
                            const year = parseInt(parts[2], 10);
                            
                            if (!isNaN(day) && !isNaN(month) && !isNaN(year)) {
                                completionDate = new Date(year, month, day);
                                
                                // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —è–≤–ª—è–µ—Ç—Å—è –ª–∏ –¥–∞—Ç–∞ —Ç–µ–∫—É—â–∏–º –º–µ—Å—è—Ü–µ–º
                                isCurrentMonth = (month === currentMonth && year === currentYear);
                                
                                // –§–æ—Ä–º–∞—Ç–∏—Ä—É–µ–º –∫–∞–∫ "–î–µ–∫–∞–±—Ä—å 2025"
                                const monthName = MONTH_NAMES_RU[month];
                                completionMonth = `${monthName} ${year}`;
                            }
                        }
                    } catch (e) {
                        console.warn(`–ù–µ —É–¥–∞–ª–æ—Å—å —Ä–∞—Å–ø–∞—Ä—Å–∏—Ç—å –¥–∞—Ç—É: ${dateStr}`, e);
                    }
                }
            }
            
            return {
                status: status,
                statusType: statusType,
                productsCount: productsCount,
                filename: filename,
                completionDate: completionDate,
                completionMonth: completionMonth,
                dateStr: dateStr,
                additionDateOriginal: additionDateOriginal,
                additionDateFormatted: additionDateFormatted,
                urgency: urgency,
                isCurrentMonth: isCurrentMonth
            };
        }
        
        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –∫–ª–∞—Å—Å–∞ —Å—Ä–æ—á–Ω–æ—Å—Ç–∏
        function getUrgencyClass(urgencyText) {
            if (!urgencyText) return 'urgency-low';
            
            const urgencyLower = urgencyText.toLowerCase();
            
            if (urgencyLower.includes('–≤—ã—Å–æ–∫') || urgencyLower.includes('—Å—Ä–æ—á–Ω') || urgencyLower.includes('urgent') || urgencyLower.includes('high')) {
                return 'urgency-high';
            } else if (urgencyLower.includes('—Å–µ–∑–æ–Ω') || urgencyLower.includes('medium') || urgencyLower.includes('normal')) {
                return 'urgency-medium';
            } else {
                return 'urgency-low';
            }
        }
        
        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –¥–∞—Ç—ã
        function formatDate(dateString) {
            if (!dateString || dateString.trim() === '') {
                return '–ù–µ —É–∫–∞–∑–∞–Ω–∞';
            }
            
            try {
                // –ü–æ–ø—Ä–æ–±—É–µ–º —Ä–∞–∑–Ω—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã –¥–∞—Ç
                const dateStr = dateString.trim();
                
                // –§–æ—Ä–º–∞—Ç DD.MM.YYYY –∏–ª–∏ DD.MM.YYYY HH:MM:SS
                const parts1 = dateStr.split('.');
                if (parts1.length >= 3) {
                    const day = parseInt(parts1[0], 10);
                    const month = parseInt(parts1[1], 10) - 1;
                    const yearPart = parts1[2].split(' ')[0];
                    const year = parseInt(yearPart, 10);
                    
                    if (!isNaN(day) && !isNaN(month) && !isNaN(year)) {
                        const date = new Date(year, month, day);
                        return date.toLocaleDateString('ru-RU', {
                            day: '2-digit',
                            month: '2-digit',
                            year: 'numeric'
                        });
                    }
                }
                
                // –§–æ—Ä–º–∞—Ç YYYY-MM-DD
                const parts2 = dateStr.split('-');
                if (parts2.length >= 3) {
                    const year = parseInt(parts2[0], 10);
                    const month = parseInt(parts2[1], 10) - 1;
                    const day = parseInt(parts2[2].split(' ')[0], 10);
                    
                    if (!isNaN(day) && !isNaN(month) && !isNaN(year)) {
                        const date = new Date(year, month, day);
                        return date.toLocaleDateString('ru-RU', {
                            day: '2-digit',
                            month: '2-digit',
                            year: 'numeric'
                        });
                    }
                }
                
                // –ï—Å–ª–∏ –Ω–∏—á–µ–≥–æ –Ω–µ —Å—Ä–∞–±–æ—Ç–∞–ª–æ, –≤–æ–∑–≤—Ä–∞—â–∞–µ–º –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—É—é —Å—Ç—Ä–æ–∫—É
                return dateStr;
            } catch (e) {
                console.warn(`–ù–µ —É–¥–∞–ª–æ—Å—å –æ—Ç—Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞—Ç—å –¥–∞—Ç—É: ${dateString}`, e);
                return dateString;
            }
        }
        
        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Ç–∏–ø–∞ —Å—Ç–∞—Ç—É—Å–∞
        function determineStatusType(status) {
            if (!status) return 'unknown';
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º —ç–º–æ–¥–∂–∏
            const emoji = getFirstEmoji(status);
            if (emoji && emoji in EMOJI_STATUSES) {
                return EMOJI_STATUSES[emoji];
            }
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º –ø–æ —Ç–µ–∫—Å—Ç—É
            const statusLower = status.toLowerCase();
            if (statusLower.includes('–∑–∞–≤–µ—Ä—à') || statusLower.includes('–≤—ã–ø–æ–ª–Ω') || statusLower.includes('–≥–æ—Ç–æ–≤')) {
                return 'completed';
            } else if (statusLower.includes('–¥–æ—Å—Ç—É–ø')) {
                return 'available';
            } else if (statusLower.includes('—Ä–∞–±–æ—Ç')) {
                return 'in_progress';
            }
            
            return 'unknown';
        }
        
        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –ø–µ—Ä–≤–æ–≥–æ —ç–º–æ–¥–∂–∏
        function getFirstEmoji(text) {
            if (!text) return '';
            const emojiRegex = /[\p{Emoji}]/u;
            const match = text.match(emojiRegex);
            return (match && match[0] in EMOJI_STATUSES) ? match[0] : '';
        }
        
        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–æ–∏—Å–∫–∞ –∏–Ω–¥–µ–∫—Å–∞ —Å—Ç–æ–ª–±—Ü–∞
        function findColumnIndex(tableHeaders, columnNames) {
            for (const columnName of columnNames) {
                let index = tableHeaders.findIndex(header => 
                    header && header.trim().toLowerCase() === columnName.toLowerCase()
                );
                
                if (index === -1) {
                    index = tableHeaders.findIndex(header => 
                        header && header.toLowerCase().includes(columnName.toLowerCase())
                    );
                }
                
                if (index !== -1) return index;
            }
            return -1;
        }
        
        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è
        function updateDisplay() {
            // –û–±–Ω–æ–≤–ª—è–µ–º –æ—Å–Ω–æ–≤–Ω—ã–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏
            document.getElementById('managerProductsToAdd').textContent = managerProductsToAdd;
            document.getElementById('contentProductsToAdd').textContent = contentProductsToAdd;
            document.getElementById('productsAddedThisMonth').textContent = productsAddedThisMonth;
            
            // –û–±–Ω–æ–≤–ª—è–µ–º —Ç–∞–±–ª–∏—Ü—ã —Ñ–∞–π–ª–æ–≤
            updateManagerFilesTable();
            updateContentFilesTable();
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –≥—Ä–∞—Ñ–∏–∫
            updateChart();
            
            // –ê–Ω–∏–º–∞—Ü–∏—è
            animateNumbers();
        }
        
        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Ç–∞–±–ª–∏—Ü—ã —Ñ–∞–π–ª–æ–≤ –º–µ–Ω–µ–¥–∂–µ—Ä–æ–≤
        function updateManagerFilesTable() {
            const tableBody = document.getElementById('managerFilesTableBody');
            tableBody.innerHTML = '';
            
            if (managerFilesForProcessing.length === 0) {
                tableBody.innerHTML = `
                    <tr>
                        <td colspan="5" style="text-align: center; padding: 40px; color: #666;">
                            <i class="fas fa-info-circle"></i> –ù–µ—Ç —Ñ–∞–π–ª–æ–≤ –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—Ç –º–µ–Ω–µ–¥–∂–µ—Ä–æ–≤
                        </td>
                    </tr>
                `;
                return;
            }
            
            // –°–æ—Ä—Ç–∏—Ä—É–µ–º —Ñ–∞–π–ª—ã –ø–æ –¥–∞—Ç–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è (–Ω–æ–≤—ã–µ —Å–≤–µ—Ä—Ö—É)
            const sortedFiles = [...managerFilesForProcessing].sort((a, b) => {
                if (!a.additionDateOriginal || !b.additionDateOriginal) return 0;
                return new Date(b.additionDateOriginal) - new Date(a.additionDateOriginal);
            });
            
            sortedFiles.forEach((file, index) => {
                const statusClass = `status-${file.statusType}`;
                const statusText = getStatusText(file.statusType);
                const urgencyClass = file.urgencyClass || 'urgency-low';
                const urgencyText = file.urgency || '–ù–µ —É–∫–∞–∑–∞–Ω–∞';
                
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td><strong>${file.filename || '–ë–µ–∑ –∏–º–µ–Ω–∏'}</strong></td>
                    <td><span class="highlight">${file.productsCount}</span> —Ç–æ–≤–∞—Ä–æ–≤</td>
                    <td class="date-cell">${file.additionDate || '–ù–µ —É–∫–∞–∑–∞–Ω–∞'}</td>
                    <td><span class="file-status ${statusClass}">${statusText}</span></td>
                    <td><span class="file-status ${urgencyClass}">${urgencyText}</span></td>
                `;
                tableBody.appendChild(row);
            });
        }
        
        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Ç–∞–±–ª–∏—Ü—ã —Ñ–∞–π–ª–æ–≤ –∫–æ–Ω—Ç–µ–Ω—Ç–∞
        function updateContentFilesTable() {
            const tableBody = document.getElementById('contentFilesTableBody');
            tableBody.innerHTML = '';
            
            if (contentFilesForProcessing.length === 0) {
                tableBody.innerHTML = `
                    <tr>
                        <td colspan="5" style="text-align: center; padding: 40px; color: #666;">
                            <i class="fas fa-info-circle"></i> –ù–µ—Ç —Ñ–∞–π–ª–æ–≤ –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∫–æ–Ω—Ç–µ–Ω—Ç–∞
                        </td>
                    </tr>
                `;
                return;
            }
            
            // –°–æ—Ä—Ç–∏—Ä—É–µ–º —Ñ–∞–π–ª—ã –ø–æ –¥–∞—Ç–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è (–Ω–æ–≤—ã–µ —Å–≤–µ—Ä—Ö—É)
            const sortedFiles = [...contentFilesForProcessing].sort((a, b) => {
                if (!a.additionDateOriginal || !b.additionDateOriginal) return 0;
                return new Date(b.additionDateOriginal) - new Date(a.additionDateOriginal);
            });
            
            sortedFiles.forEach((file, index) => {
                const statusClass = `status-${file.statusType}`;
                const statusText = getStatusText(file.statusType);
                const urgencyClass = file.urgencyClass || 'urgency-low';
                const urgencyText = file.urgency || '–ù–µ —É–∫–∞–∑–∞–Ω–∞';
                
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td><strong>${file.filename || '–ë–µ–∑ –∏–º–µ–Ω–∏'}</strong></td>
                    <td><span class="highlight">${file.productsCount}</span> —Ç–æ–≤–∞—Ä–æ–≤</td>
                    <td class="date-cell">${file.additionDate || '–ù–µ —É–∫–∞–∑–∞–Ω–∞'}</td>
                    <td><span class="file-status ${statusClass}">${statusText}</span></td>
                    <td><span class="file-status ${urgencyClass}">${urgencyText}</span></td>
                `;
                tableBody.appendChild(row);
            });
        }
        
        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –≥—Ä–∞—Ñ–∏–∫–∞
        function updateChart() {
            const ctx = document.getElementById('monthlyChart').getContext('2d');
            
            // –£–¥–∞–ª—è–µ–º —Å—Ç–∞—Ä—ã–π –≥—Ä–∞—Ñ–∏–∫, –µ—Å–ª–∏ –æ–Ω —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
            if (monthlyChart) {
                monthlyChart.destroy();
            }
            
            // –ü–æ–¥–≥–æ—Ç–∞–≤–ª–∏–≤–∞–µ–º –¥–∞–Ω–Ω—ã–µ –¥–ª—è –≥—Ä–∞—Ñ–∏–∫–∞
            const labels = monthlyData.map(item => item.month);
            const data = monthlyData.map(item => item.total);
            
            // –û–ø—Ä–µ–¥–µ–ª—è–µ–º –ø–µ—Ä–∏–æ–¥ –¥–ª—è –∑–∞–≥–æ–ª–æ–≤–∫–∞
            const chartPeriod = document.getElementById('chartPeriod');
            if (labels.length > 0) {
                chartPeriod.textContent = `–ü–µ—Ä–∏–æ–¥: ${labels[0]} - ${labels[labels.length - 1]}`;
            } else {
                chartPeriod.textContent = '–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –∑–∞ –≤—ã–±—Ä–∞–Ω–Ω—ã–π –ø–µ—Ä–∏–æ–¥';
            }
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –≤—Ä–µ–º—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
            document.getElementById('chartUpdateTime').textContent = new Date().toLocaleString('ru-RU');
            
            // –°–æ–∑–¥–∞–µ–º –Ω–æ–≤—ã–π –≥—Ä–∞—Ñ–∏–∫
            monthlyChart = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: labels,
                    datasets: [{
                        label: '–¢–æ–≤–∞—Ä–æ–≤ –¥–æ–±–∞–≤–ª–µ–Ω–æ',
                        data: data,
                        backgroundColor: labels.map((_, index) => {
                            // –ì—Ä–∞–¥–∏–µ–Ω—Ç —Ü–≤–µ—Ç–æ–≤ –¥–ª—è —Å—Ç–æ–ª–±—Ü–æ–≤
                            const hue = 200 + (index * 30) % 155;
                            return `hsla(${hue}, 70%, 60%, 0.8)`;
                        }),
                        borderColor: labels.map((_, index) => {
                            const hue = 200 + (index * 30) % 155;
                            return `hsla(${hue}, 70%, 50%, 1)`;
                        }),
                        borderWidth: 2,
                        borderRadius: 5,
                        hoverBackgroundColor: labels.map((_, index) => {
                            const hue = 200 + (index * 30) % 155;
                            return `hsla(${hue}, 80%, 70%, 1)`;
                        })
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            display: false
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    return `–¢–æ–≤–∞—Ä–æ–≤: ${context.parsed.y.toLocaleString('ru-RU')}`;
                                }
                            }
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            title: {
                                display: true,
                                text: '–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç–æ–≤–∞—Ä–æ–≤',
                                font: {
                                    size: 14,
                                    weight: 'bold'
                                }
                            },
                            ticks: {
                                callback: function(value) {
                                    return value.toLocaleString('ru-RU');
                                }
                            }
                        },
                        x: {
                            title: {
                                display: true,
                                text: '–ú–µ—Å—è—Ü –∏ –≥–æ–¥',
                                font: {
                                    size: 14,
                                    weight: 'bold'
                                }
                            }
                        }
                    },
                    animation: {
                        duration: 1000,
                        easing: 'easeOutQuart'
                    }
                }
            });
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –ª–µ–≥–µ–Ω–¥—É
            updateChartLegend();
        }
        
        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –ª–µ–≥–µ–Ω–¥—ã –≥—Ä–∞—Ñ–∏–∫–∞
        function updateChartLegend() {
            const legendContainer = document.getElementById('chartLegend');
            
            if (monthlyData.length === 0) {
                legendContainer.innerHTML = '<div class="legend-item"><i class="fas fa-info-circle"></i> –ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è</div>';
                return;
            }
            
            let legendHTML = '';
            monthlyData.forEach((item, index) => {
                const hue = 200 + (index * 30) % 155;
                const color = `hsl(${hue}, 70%, 60%)`;
                
                legendHTML += `
                    <div class="legend-item">
                        <div class="legend-color" style="background-color: ${color};"></div>
                        <span>${item.month}: <strong>${item.total.toLocaleString('ru-RU')}</strong> —Ç–æ–≤–∞—Ä–æ–≤</span>
                    </div>
                `;
            });
            
            legendContainer.innerHTML = legendHTML;
        }
        
        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Ç–µ–∫—Å—Ç–∞ —Å—Ç–∞—Ç—É—Å–∞
        function getStatusText(statusType) {
            switch(statusType) {
                case 'in_progress': return 'üîÑ –í —Ä–∞–±–æ—Ç–µ';
                case 'available': return 'üÜï –î–æ—Å—Ç—É–ø–Ω–æ';
                case 'completed': return '‚úÖ –ó–∞–≤–µ—Ä—à–µ–Ω–æ';
                default: return '‚ùì –ù–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω';
            }
        }
        
        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–æ–∫–∞–∑–∞ –¥–µ–º–æ-–¥–∞–Ω–Ω—ã—Ö
        function showDemoData() {
            const loading = document.getElementById('loading');
            const statsSection = document.getElementById('statsSection');
            const warningMessage = document.getElementById('warningMessage');
            
            // –¢–µ–∫—É—â–∞—è –¥–∞—Ç–∞ –¥–ª—è –¥–µ–º–æ-–¥–∞–Ω–Ω—ã—Ö
            const currentDate = new Date();
            currentMonth = currentDate.getMonth();
            currentYear = currentDate.getFullYear();
            
            // –î–µ–º–æ-–¥–∞–Ω–Ω—ã–µ –¥–ª—è –º–µ–Ω–µ–¥–∂–µ—Ä–æ–≤
            managerProductsToAdd = 85;
            
            // –î–µ–º–æ-–¥–∞–Ω–Ω—ã–µ –¥–ª—è –∫–æ–Ω—Ç–µ–Ω—Ç–∞
            contentProductsToAdd = 45;
            
            // –î–µ–º–æ-–¥–∞–Ω–Ω—ã–µ –¥–ª—è –∑–∞–≤–µ—Ä—à–µ–Ω–Ω—ã—Ö –≤ —Ç–µ–∫—É—â–µ–º –º–µ—Å—è—Ü–µ
            productsAddedThisMonth = 42;
            
            // –î–µ–º–æ-—Ñ–∞–π–ª—ã –¥–ª—è –º–µ–Ω–µ–¥–∂–µ—Ä–æ–≤
            managerFilesForProcessing = [
                { 
                    filename: '–ö–∞—Ç–∞–ª–æ–≥_—Ç–æ–≤–∞—Ä–æ–≤_1.xlsx', 
                    productsCount: 25, 
                    statusType: 'in_progress', 
                    additionDate: '15.03.2024',
                    urgency: '–í—ã—Å–æ–∫–∞—è',
                    urgencyClass: 'urgency-high'
                },
                { 
                    filename: '–ö–∞—Ç–∞–ª–æ–≥_—Ç–æ–≤–∞—Ä–æ–≤_2.xlsx', 
                    productsCount: 30, 
                    statusType: 'available', 
                    additionDate: '22.03.2024',
                    urgency: '–°—Ä–µ–¥–Ω—è—è',
                    urgencyClass: 'urgency-medium'
                },
                { 
                    filename: '–ö–∞—Ç–∞–ª–æ–≥_—Ç–æ–≤–∞—Ä–æ–≤_3.xlsx', 
                    productsCount: 20, 
                    statusType: 'in_progress', 
                    additionDate: '28.03.2024',
                    urgency: '–ù–∏–∑–∫–∞—è',
                    urgencyClass: 'urgency-low'
                },
                { 
                    filename: '–ö–∞—Ç–∞–ª–æ–≥_—Ç–æ–≤–∞—Ä–æ–≤_4.xlsx', 
                    productsCount: 10, 
                    statusType: 'available', 
                    additionDate: '05.04.2024',
                    urgency: '',
                    urgencyClass: 'urgency-low'
                }
            ];
            
            // –î–µ–º–æ-—Ñ–∞–π–ª—ã –¥–ª—è –∫–æ–Ω—Ç–µ–Ω—Ç–∞
            contentFilesForProcessing = [
                { 
                    filename: '–ö–æ–Ω—Ç–µ–Ω—Ç_—Ç–æ–≤–∞—Ä–æ–≤_1.xlsx', 
                    productsCount: 15, 
                    statusType: 'in_progress', 
                    additionDate: '10.03.2024',
                    urgency: '–í—ã—Å–æ–∫–∞—è',
                    urgencyClass: 'urgency-high'
                },
                { 
                    filename: '–ö–æ–Ω—Ç–µ–Ω—Ç_—Ç–æ–≤–∞—Ä–æ–≤_2.xlsx', 
                    productsCount: 20, 
                    statusType: 'available', 
                    additionDate: '18.03.2024',
                    urgency: '–°—Ä–µ–¥–Ω—è—è',
                    urgencyClass: 'urgency-medium'
                },
                { 
                    filename: '–ö–æ–Ω—Ç–µ–Ω—Ç_—Ç–æ–≤–∞—Ä–æ–≤_3.xlsx', 
                    productsCount: 10, 
                    statusType: 'in_progress', 
                    additionDate: '25.03.2024',
                    urgency: '–ù–∏–∑–∫–∞—è',
                    urgencyClass: 'urgency-low'
                }
            ];
            
            // –î–µ–º–æ-–¥–∞–Ω–Ω—ã–µ –¥–ª—è –≥—Ä–∞—Ñ–∏–∫–∞ (–æ–±—ä–µ–¥–∏–Ω–µ–Ω–Ω—ã–µ)
            monthlyData = [
                { month: '–ù–æ—è–±—Ä—å 2024', total: 65 },
                { month: '–î–µ–∫–∞–±—Ä—å 2024', total: 88 },
                { month: '–Ø–Ω–≤–∞—Ä—å 2025', total: 72 },
                { month: '–§–µ–≤—Ä–∞–ª—å 2025', total: 109 },
                { month: '–ú–∞—Ä—Ç 2025', total: 96 },
                { month: `${MONTH_NAMES_RU[currentMonth]} ${currentYear}`, total: productsAddedThisMonth }
            ];
            
            isDemoData = true;
            updateDisplay();
            
            loading.style.display = 'none';
            statsSection.style.display = 'block';
            warningMessage.style.display = 'block';
        }
        
        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –∞–Ω–∏–º–∞—Ü–∏–∏ —á–∏—Å–µ–ª
        function animateNumbers() {
            const numbers = document.querySelectorAll('.summary-number');
            numbers.forEach(number => {
                number.classList.add('pulse');
                setTimeout(() => number.classList.remove('pulse'), 1000);
            });
        }
        
        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–∞—Ä—Å–∏–Ω–≥–∞ CSV —Å—Ç—Ä–æ–∫–∏
        function parseCSVRow(row) {
            const result = [];
            let current = '';
            let inQuotes = false;
            
            for (let i = 0; i < row.length; i++) {
                const char = row[i];
                const nextChar = row[i + 1];
                
                if (char === '"') {
                    if (inQuotes && nextChar === '"') {
                        current += '"';
                        i++;
                    } else {
                        inQuotes = !inQuotes;
                    }
                } else if (char === ',' && !inQuotes) {
                    result.push(current);
                    current = '';
                } else {
                    current += char;
                }
            }
            
            result.push(current);
            return result.map(cell => cell.trim());
        }
        
        // –ó–∞–≥—Ä—É–∂–∞–µ–º –¥–∞–Ω–Ω—ã–µ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        document.addEventListener('DOMContentLoaded', loadData);
    </script>
