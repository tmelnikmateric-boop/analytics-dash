<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ó–∞–≥—Ä—É–∑–∫–∞ –Ω–æ–≤—ã—Ö —Ç–æ–≤–∞—Ä–æ–≤ –Ω–∞ —Å–∞–π—Ç</title>
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><rect width='100' height='100' rx='20' fill='%23ff8c00'/><path d='M50 25 L75 50 L50 75 L25 50 Z' fill='white'/></svg>">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            min-height: 100vh;
            padding: 20px;
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
        }
        
        .container {
            width: 100%;
            max-width: 1400px;
            margin: 0 auto;
            background-color: white;
            border-radius: 20px;
            box-shadow: 0 25px 50px rgba(0,0,0,0.15);
            overflow: hidden;
        }
        
        header {
            background: linear-gradient(90deg, #ff8c00 0%, #FFB500 100%);
            color: white;
            padding: 40px 30px;
            text-align: center;
            position: relative;
        }
        
        h1 {
            font-size: 2.8em;
            margin-bottom: 15px;
            font-weight: 700;
        }
        
        .subtitle {
            font-size: 1.2em;
            opacity: 0.9;
            font-weight: 300;
            margin-bottom: 20px;
        }
        
        .header-buttons {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-top: 20px;
            flex-wrap: wrap;
        }
        
        .btn-rules {
            background: rgba(255, 255, 255, 0.2);
            color: white;
            border: 2px solid white;
            padding: 10px 25px;
            border-radius: 50px;
            font-size: 1em;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 8px;
            backdrop-filter: blur(5px);
        }
        
        .btn-rules:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }
        
        .content {
            padding: 40px 30px;
        }
        
        .products-summary {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 25px;
            margin-bottom: 40px;
        }
        
        .summary-card {
            border-radius: 15px;
            padding: 30px;
            border: 2px solid #e0e0e0;
            box-shadow: 0 10px 30px rgba(0,0,0,0.08);
            text-align: center;
            transition: transform 0.3s;
        }
        
        .summary-card:hover {
            transform: translateY(-5px);
        }
        
        .summary-card.important {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }
        
        .summary-card.important-2 {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            color: white;
        }
        
        .summary-card.important-3 {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            color: white;
        }
        
        .summary-card.important .summary-number,
        .summary-card.important-2 .summary-number,
        .summary-card.important-3 .summary-number {
            color: white;
        }
        
        .summary-number {
            font-size: 3.5em;
            font-weight: 800;
            color: #ffc73f;
            margin: 15px 0;
        }
        
        .summary-label {
            font-size: 1.3em;
            color: #555;
            font-weight: 600;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }
        
        .summary-card.important .summary-label,
        .summary-card.important-2 .summary-label,
        .summary-card.important-3 .summary-label {
            color: rgba(255,255,255,0.9);
        }
        
        .summary-subtitle {
            font-size: 0.9em;
            color: #777;
            margin-top: 10px;
        }
        
        .summary-card.important .summary-subtitle,
        .summary-card.important-2 .summary-subtitle,
        .summary-card.important-3 .summary-subtitle {
            color: rgba(255,255,255,0.9);
        }
        
        .files-table-container {
            margin: 40px 0;
            overflow-x: auto;
        }
        
        .section-title {
            color: #333;
            margin-bottom: 25px;
            text-align: center;
            font-size: 1.8em;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }
        
        .section-title i {
            font-size: 1.2em;
        }
        
        .files-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 15px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.05);
            border-radius: 10px;
            overflow: hidden;
        }
        
        .files-table th {
            background: linear-gradient(90deg, #b99131 0%, #ffb500 100%);
            color: white;
            padding: 15px;
            text-align: left;
            font-weight: 600;
        }
        
        .files-table td {
            padding: 15px;
            border-bottom: 1px solid #eee;
            color: #333;
        }
        
        .files-table tr:nth-child(even) {
            background-color: #f8f9fa;
        }
        
        .files-table tr:hover {
            background-color: #e9ecef;
        }
        
        .file-status {
            display: inline-flex;
            align-items: center;
            gap: 6px;
            padding: 4px 10px;
            border-radius: 15px;
            font-size: 0.85em;
            font-weight: 500;
        }
        
        .status-completed {
            background-color: #d4edda;
            color: #155724;
        }
        
        .status-in-progress {
            background-color: #cce5ff;
            color: #004085;
        }
        
        .status-available {
            background-color: #d1ecf1;
            color: #0c5460;
        }
        
        .urgency-high {
            background-color: #f8d7da;
            color: #721c24;
            font-weight: bold;
        }
        
        .urgency-medium {
            background-color: #fff3cd;
            color: #856404;
        }
        
        .urgency-low {
            background-color: #d1ecf1;
            color: #0c5460;
        }
        
        .days-indicator {
            display: inline-flex;
            align-items: center;
            gap: 6px;
            padding: 4px 10px;
            border-radius: 15px;
            font-size: 0.85em;
            font-weight: 500;
            background-color: #e8f4f8;
            color: #0c5460;
        }
        
        .days-high {
            background-color: #f8d7da;
            color: #721c24;
            font-weight: bold;
        }
        
        .days-medium {
            background-color: #fff3cd;
            color: #856404;
        }
        
        .days-low {
            background-color: #d1ecf1;
            color: #0c5460;
        }
        
        .buttons {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin-top: 40px;
            flex-wrap: wrap;
        }
        
        .btn {
            background: linear-gradient(90deg, #ff8c00 0%, #FFB500 100%);
            color: white;
            border: none;
            padding: 15px 35px;
            border-radius: 50px;
            font-size: 1.1em;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(0,0,0,0.2);
        }
        
        .loading {
            text-align: center;
            padding: 60px 40px;
            font-size: 1.2em;
            color: #666;
            background: #f8f9fa;
            border-radius: 10px;
            margin: 20px 0;
        }
        
        .warning {
            background-color: #fff3cd;
            color: #856404;
            padding: 15px;
            border-radius: 8px;
            border-left: 5px solid #ffc107;
            margin: 20px 0;
        }
        
        .error {
            background-color: #ffe6e6;
            color: #cc0000;
            padding: 20px;
            border-radius: 10px;
            border-left: 5px solid #cc0000;
            margin: 20px 0;
        }
        
        .highlight {
            background-color: #fff3cd;
            padding: 3px 8px;
            border-radius: 4px;
            font-weight: 600;
        }
        
        .date-cell {
            font-size: 0.9em;
            color: #666;
            white-space: nowrap;
        }
        
        .last-update {
            font-size: 0.85em;
            color: #888;
            margin-top: 5px;
            font-style: italic;
        }
        
        .debug-info {
            background-color: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            border-left: 4px solid #6c757d;
            margin: 20px 0;
            font-family: monospace;
            font-size: 0.9em;
            max-height: 200px;
            overflow-y: auto;
        }
        
        .data-source-info {
            background-color: #e8f4f8;
            padding: 10px 15px;
            border-radius: 8px;
            border-left: 4px solid #17a2b8;
            margin: 15px 0;
            font-size: 0.9em;
        }
        
        .last-update-info {
            text-align: center;
            font-size: 0.9em;
            color: #666;
            margin-top: 20px;
            padding: 10px;
            background-color: #f8f9fa;
            border-radius: 8px;
        }
        
        .btn-success {
            background: linear-gradient(90deg, #28a745 0%, #20c997 100%);
        }
        
        .chart-container {
            background: white;
            border-radius: 15px;
            padding: 30px;
            margin: 40px 0;
            box-shadow: 0 10px 30px rgba(0,0,0,0.08);
            border: 2px solid #e0e0e0;
        }
        
        .chart-title {
            text-align: center;
            margin-bottom: 25px;
            color: #333;
            font-size: 1.8em;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }
        
        .chart-wrapper {
            position: relative;
            height: 400px;
            margin-top: 20px;
        }
        
        .no-data-message {
            text-align: center;
            padding: 60px 40px;
            color: #666;
            font-style: italic;
            font-size: 1.1em;
        }
        
        .chart-stats {
            display: flex;
            justify-content: space-around;
            margin-top: 20px;
            padding: 15px;
            background-color: #f8f9fa;
            border-radius: 10px;
            flex-wrap: wrap;
            gap: 15px;
        }
        
        .stat-item {
            text-align: center;
            padding: 10px 20px;
        }
        
        .stat-value {
            font-size: 2em;
            font-weight: 700;
            color: #ff8c00;
            margin-bottom: 5px;
        }
        
        .stat-label {
            font-size: 0.9em;
            color: #666;
        }
        
        .chart-controls {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }
        
        .chart-btn {
            background: #f8f9fa;
            border: 2px solid #dee2e6;
            padding: 8px 20px;
            border-radius: 20px;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.3s;
        }
        
        .chart-btn:hover {
            background: #e9ecef;
        }
        
        .chart-btn.active {
            background: #ff8c00;
            color: white;
            border-color: #ff8c00;
        }
        
        /* –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Å—Ç–∏–ª–∏ */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            z-index: 1000;
            animation: fadeIn 0.3s ease;
        }
        
        .modal-content {
            position: relative;
            background-color: white;
            margin: 5% auto;
            padding: 0;
            width: 90%;
            max-width: 800px;
            border-radius: 20px;
            box-shadow: 0 25px 50px rgba(0,0,0,0.3);
            animation: slideIn 0.3s ease;
            overflow: hidden;
        }
        
        .modal-header {
            background: linear-gradient(90deg, #ff8c00 0%, #FFB500 100%);
            color: white;
            padding: 25px 30px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .modal-header h2 {
            margin: 0;
            font-size: 1.8em;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .close-modal {
            background: none;
            border: none;
            color: white;
            font-size: 1.5em;
            cursor: pointer;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s;
        }
        
        .close-modal:hover {
            background-color: rgba(255, 255, 255, 0.2);
        }
        
        .modal-body {
            padding: 30px;
            max-height: 70vh;
            overflow-y: auto;
        }
        
        .info-section {
            margin-bottom: 25px;
            padding-bottom: 25px;
            border-bottom: 1px solid #eee;
        }
        
        .info-section:last-child {
            border-bottom: none;
            margin-bottom: 0;
            padding-bottom: 0;
        }
        
        .info-section h3 {
            color: #ff8c00;
            margin-bottom: 15px;
            font-size: 1.4em;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .info-section p {
            line-height: 1.6;
            color: #555;
            margin-bottom: 10px;
        }
        
        .info-section ul {
            padding-left: 20px;
            margin-bottom: 15px;
        }
        
        .info-section li {
            margin-bottom: 8px;
            line-height: 1.5;
            color: #555;
        }
        
        .feature-list {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }
        
        .feature-item {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 10px;
            border-left: 4px solid #ff8c00;
        }
        
        .feature-item h4 {
            color: #333;
            margin-bottom: 8px;
            font-size: 1.1em;
        }
        
        .feature-item p {
            font-size: 0.9em;
            margin-bottom: 0;
            color: #666;
        }
        
        .status-indicator {
            display: inline-flex;
            align-items: center;
            gap: 5px;
            padding: 3px 8px;
            border-radius: 12px;
            font-size: 0.8em;
            margin-right: 5px;
            margin-bottom: 5px;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        @keyframes slideIn {
            from { transform: translateY(-50px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }
        
        @media (max-width: 768px) {
            .container {
                margin: 10px;
                border-radius: 15px;
            }
            
            header {
                padding: 30px 20px;
            }
            
            h1 {
                font-size: 2.2em;
            }
            
            .content {
                padding: 30px 20px;
            }
            
            .summary-number {
                font-size: 2.5em;
            }
            
            .products-summary {
                grid-template-columns: 1fr;
            }
            
            .btn, .btn-rules {
                padding: 12px 25px;
                font-size: 1em;
                width: 100%;
                justify-content: center;
            }
            
            .buttons {
                flex-direction: column;
            }
            
            .header-buttons {
                flex-direction: column;
            }
            
            .files-table th, .files-table td {
                padding: 10px 8px;
                font-size: 0.9em;
            }
            
            .chart-wrapper {
                height: 300px;
            }
            
            .modal-content {
                width: 95%;
                margin: 10% auto;
            }
            
            .modal-header {
                padding: 20px;
            }
            
            .modal-body {
                padding: 20px;
                max-height: 60vh;
            }
        }
     /* –°—Ç–∏–ª–∏ –¥–ª—è –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ */
      .process-container {
    max-width: 1200px;
    margin: 0 auto;
    padding: 20px;
}

/* –°—Ç–∏–ª–∏ –¥–ª—è —Ç–∞–π–º–ª–∞–π–Ω–∞ (—É–∂–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ) */
.compact-timeline {
    font-family: 'Segoe UI', system-ui, sans-serif;
    padding: 30px 20px;
    background: #f8fafc;
    border-radius: 16px;
    margin-bottom: 30px;
}

.timeline-container {
    max-width: 1100px;
    width: 100%;
    position: relative;
    display: flex;
    justify-content: space-between;
    align-items: flex-start;
    margin: 0 auto;
}

.timeline-line {
    position: absolute;
    left: 60px;
    right: 60px;
    top: 35px;
    height: 3px;
    background: linear-gradient(90deg, #4f46e5, #7c3aed, #db2777, #dc2626);
    z-index: 1;
}

.timeline-step {
    width: 23%;
    position: relative;
    z-index: 2;
    flex-shrink: 0;
}

.step-marker {
    width: 36px;
    height: 36px;
    margin: 0 auto 15px;
    background: white;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
    position: relative;
    z-index: 3;
}

.step-number {
    font-size: 16px;
    font-weight: 700;
    color: white;
    width: 28px;
    height: 28px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
}

.step-content {
    background: white;
    padding: 20px 15px;
    border-radius: 12px;
    box-shadow: 0 5px 15px rgba(0, 0, 0, 0.06);
    min-height: 160px;
    display: flex;
    flex-direction: column;
    align-items: center;
    text-align: center;
    border-top: 3px solid;
}

.step-icon {
    font-size: 28px;
    margin-bottom: 12px;
}

.step-title {
    color: #1e293b;
    font-size: 16px;
    font-weight: 600;
    margin: 0 0 8px 0;
}

.step-desc {
    color: #64748b;
    font-size: 13px;
    line-height: 1.5;
    margin: 0;
}

.highlight {
    background: linear-gradient(120deg, #f0f9ff 0%, #e0f2fe 100%);
    color: #0369a1;
    padding: 1px 5px;
    border-radius: 4px;
    font-weight: 500;
    font-size: 12px;
}

.step-1 .step-number { background: linear-gradient(135deg, #4f46e5, #6366f1); }
.step-1 .step-content { border-top-color: #4f46e5; }
.step-2 .step-number { background: linear-gradient(135deg, #7c3aed, #8b5cf6); }
.step-2 .step-content { border-top-color: #7c3aed; }
.step-3 .step-number { background: linear-gradient(135deg, #db2777, #ec4899); }
.step-3 .step-content { border-top-color: #db2777; }
.step-4 .step-number { background: linear-gradient(135deg, #dc2626, #ef4444); }
.step-4 .step-content { border-top-color: #dc2626; }

.step-timing {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 6px;
    flex-wrap: wrap;
    margin-top: 5px;
}

.clock { font-size: 14px; }
.time { font-weight: 600; color: #1e293b; font-size: 13px; }
.note { color: #94a3b8; font-size: 11px; font-style: italic; }

/* –°—Ç–∏–ª–∏ –¥–ª—è –±–ª–æ–∫–∞ —Å –≤–∞–∂–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π */
.important-notice {
    background: linear-gradient(135deg, #fff7ed 0%, #ffedd5 100%);
    border-radius: 16px;
    padding: 25px 30px;
    border: 2px solid #fdba74;
    box-shadow: 0 8px 25px rgba(251, 146, 60, 0.15);
    margin-top: 10px;
}

.notice-header {
    display: flex;
    align-items: center;
    gap: 15px;
    margin-bottom: 25px;
    padding-bottom: 15px;
    border-bottom: 2px solid rgba(251, 146, 60, 0.3);
}

.warning-icon {
    font-size: 32px;
    flex-shrink: 0;
}

.notice-title {
    color: #ea580c;
    font-size: 22px;
    font-weight: 700;
    margin: 0;
    flex-grow: 1;
}

.notice-content {
    display: flex;
    flex-direction: column;
    gap: 20px;
}

.priority-item {
    display: flex;
    align-items: flex-start;
    gap: 15px;
    padding: 15px;
    background: rgba(255, 255, 255, 0.7);
    border-radius: 12px;
    transition: transform 0.2s ease;
}

.priority-item:hover {
    transform: translateX(5px);
    background: white;
}

.priority-marker {
    width: 32px;
    height: 32px;
    border-radius: 8px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-weight: 700;
    font-size: 16px;
    color: white;
    flex-shrink: 0;
    margin-top: 2px;
}

.priority-marker.primary {
    background: linear-gradient(135deg, #059669, #10b981);
    box-shadow: 0 4px 10px rgba(5, 150, 105, 0.3);
}

.priority-marker.secondary {
    background: linear-gradient(135deg, #2563eb, #3b82f6);
    box-shadow: 0 4px 10px rgba(37, 99, 235, 0.3);
}

.priority-marker.urgent {
    background: linear-gradient(135deg, #dc2626, #ef4444);
    box-shadow: 0 4px 10px rgba(220, 38, 38, 0.3);
}

.priority-text {
    color: #4b5563;
    font-size: 15px;
    line-height: 1.6;
    flex-grow: 1;
}

.highlight-text {
    color: #059669;
    font-weight: 600;
    background: rgba(5, 150, 105, 0.1);
    padding: 2px 6px;
    border-radius: 4px;
}

.sublist {
    margin: 8px 0 0 20px;
    color: #6b7280;
    font-size: 14px;
}

.sublist li {
    margin-bottom: 4px;
    line-height: 1.5;
}

.urgent-note {
    margin-top: 10px;
    padding: 12px;
    background: linear-gradient(135deg, #fef2f2, #fee2e2);
    border-radius: 8px;
    border-left: 4px solid #dc2626;
    display: flex;
    align-items: center;
    gap: 10px;
    font-size: 14px;
}

.alert-icon {
    font-size: 18px;
    flex-shrink: 0;
}

.highlight-alert {
    color: #dc2626;
    font-weight: 700;
    background: rgba(220, 38, 38, 0.1);
    padding: 2px 6px;
    border-radius: 4px;
    animation: pulse 2s infinite;
}

@keyframes pulse {
    0%, 100% { opacity: 1; }
    50% { opacity: 0.8; }
}

.timing-note {
    display: flex;
    align-items: center;
    gap: 15px;
    padding: 18px;
    background: linear-gradient(135deg, #f0f9ff, #e0f2fe);
    border-radius: 12px;
    margin-top: 10px;
    border: 1px solid #bae6fd;
}

.timing-icon {
    font-size: 24px;
    flex-shrink: 0;
}

.timing-text {
    color: #0369a1;
    font-size: 16px;
    font-weight: 600;
    flex-grow: 1;
}

/* –ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å */
@media (max-width: 1100px) {
    .timeline-container {
        flex-wrap: wrap;
        gap: 20px;
    }
    
    .timeline-step {
        width: 48%;
        min-width: 250px;
    }
    
    .timeline-line {
        display: none;
    }
}

@media (max-width: 768px) {
    .process-container {
        padding: 15px;
    }
    
    .compact-timeline {
        padding: 20px 15px;
    }
    
    .timeline-step {
        width: 100%;
        max-width: 300px;
        margin: 0 auto 20px;
    }
    
    .important-notice {
        padding: 20px;
    }
    
    .notice-header {
        flex-direction: column;
        text-align: center;
        gap: 10px;
    }
    
    .notice-title {
        font-size: 20px;
    }
    
    .priority-item {
        flex-direction: column;
        gap: 10px;
        padding: 15px;
    }
    
    .priority-marker {
        align-self: flex-start;
    }
    
    .timing-note {
        flex-direction: column;
        text-align: center;
        gap: 10px;
    }
}  
         
    </style>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <!-- Chart.js –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ –¥–ª—è –¥–∏–∞–≥—Ä–∞–º–º -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ -->
    <div id="infoModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2><i class="fas fa-info-circle"></i> –ü—Ä–æ—Ü–µ—Å—Å —Ä–∞–±–æ—Ç—ã –æ—Ç–¥–µ–ª–∞ –∫–æ–Ω—Ç–µ–Ω—Ç–∞</h2>
                <button class="close-modal" onclick="closeModal()">&times;</button>
            </div>
            <div class="modal-body">

               <div class="process-container">
    <!-- –¢–∞–π–º–ª–∞–π–Ω (–ø—Ä–µ–¥—ã–¥—É—â–∏–π –∫–æ–¥) -->
    <div class="compact-timeline">
        <div class="timeline-container">
            <div class="timeline-line"></div>
            
            <div class="timeline-step step-1">
                <div class="step-marker"><span class="step-number">1</span></div>
                <div class="step-content">
                    <div class="step-icon">üìÅ</div>
                    <div class="step-info">
                        <h4 class="step-title">–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞</h4>
                        <p class="step-desc">–ú–µ–Ω–µ–¥–∂–µ—Ä —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç —à–∞–±–ª–æ–Ω –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è —Ç–æ–≤–∞—Ä–æ–≤ —Å–æ —Å–≤–æ–µ–≥–æ —Ñ–∞–π–ª–∞ –∏–∑ –ø–∞–ø–∫–∏ <span class="highlight">"–ö–ê–ú_—Ä–∞–±–æ—Ç–∞–µ–º_–∑–¥–µ—Å—å"</span></p>
                    </div>
                </div>
            </div>
            
            <div class="timeline-step step-2">
                <div class="step-marker"><span class="step-number">2</span></div>
                <div class="step-content">
                    <div class="step-icon">üì∏</div>
                    <div class="step-info">
                        <h4 class="step-title">–°–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö</h4>
                        <p class="step-desc">–ó–∞–ø—Ä–∞—à–∏–≤–∞–µ—Ç—Å—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Ç–æ–≤–∞—Ä–∞—Ö –∏ —Ñ–æ—Ç–æ —É –ø–æ—Å—Ç–∞–≤—â–∏–∫–∞</p>
                    </div>
                </div>
            </div>
            
            <div class="timeline-step step-3">
                <div class="step-marker"><span class="step-number">3</span></div>
                <div class="step-content">
                    <div class="step-icon">üì§</div>
                    <div class="step-info">
                        <h4 class="step-title">–ü–µ—Ä–µ–¥–∞—á–∞</h4>
                        <p class="step-desc">–û—Ç–ø—Ä–∞–≤–∫–∞ –≤ <span class="highlight">"–ö–æ–Ω—Ç–µ–Ω—Ç-–æ—Ç–¥–µ–ª"</span> –ø–æ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω–Ω—ã–π –º–∞—Ç–µ—Ä–∏–∞–ª</p>
                    </div>
                </div>
            </div>
            
            <div class="timeline-step step-4">
                <div class="step-marker"><span class="step-number">4</span></div>
                <div class="step-content">
                    <div class="step-icon">‚úèÔ∏è</div>
                    <div class="step-info">
                        <h4 class="step-title">–û–±—Ä–∞–±–æ—Ç–∫–∞</h4>
                        <div class="step-timing">
                            <span class="clock">‚è±</span>
                            <span class="time">~2 –¥–Ω—è</span>
                            <span class="note">(–∑–∞–≤–∏—Å–∏—Ç –æ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –¥–∞–Ω–Ω—ã—Ö)</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- –ë–ª–æ–∫ —Å –≤–∞–∂–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π -->
    <div class="important-notice">
        <div class="notice-header">
            <div class="warning-icon">‚ö†Ô∏è</div>
            <h3 class="notice-title">–í–∞–∂–Ω–æ! –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç—ã –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Ñ–∞–π–ª–æ–≤</h3>
        </div>
        
        <div class="notice-content">
            <div class="priority-item">
                <div class="priority-marker primary">1</div>
                <div class="priority-text">
                    <strong>–§–∞–π–ª—ã –æ—Ç –º–µ–Ω–µ–¥–∂–µ—Ä–æ–≤</strong> –±–µ—Ä—É—Ç—Å—è –≤ —Ä–∞–±–æ—Ç—É –≤ –ø–µ—Ä–≤—É—é –æ—á–µ—Ä–µ–¥—å, —Å—Ç–∞–Ω–æ–≤—è—Ç—Å—è –≤ –æ—á–µ—Ä–µ–¥—å –ø–æ –¥–∞—Ç–µ –ø–æ—Å—Ç—É–ø–ª–µ–Ω–∏—è.
                </div>
            </div>
            
            <div class="priority-item">
                <div class="priority-marker secondary">2</div>
                <div class="priority-text">
                    –ü—Ä–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ —Ñ–∞–π–ª–æ–≤ –æ—Ç –º–µ–Ω–µ–¥–∂–µ—Ä–æ–≤ —Ä–∞–±–æ—Ç–∞ –≤–µ–¥—ë—Ç—Å—è –ø–æ –∑–∞–≥—Ä—É–∑–∫–µ –∞—Å—Å–æ—Ä—Ç–∏–º–µ–Ω—Ç–∞:
                    <ul class="sublist">
                        <li>–ø–æ—Å–ª–µ –æ—Ç–∫—Ä—ã—Ç–∏—è –Ω–æ–≤—ã—Ö –≥—Ä—É–ø–ø —Ç–æ–≤–∞—Ä–æ–≤</li>
                        <li>–ø—Ä–∏ —Å–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–æ–º –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–µ —Ñ–∞–π–ª–æ–≤ –ö–ê–ú</li>
                    </ul>
                </div>
            </div>
            
            <div class="priority-item">
                <div class="priority-marker urgent">!</div>
                <div class="priority-text">
                    <strong>–°—Ä–æ—á–Ω—ã–µ –∏ —Å–µ–∑–æ–Ω–Ω—ã–µ —Ç–æ–≤–∞—Ä—ã:</strong> –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –ø—Ä–∏ –Ω–∞–ª–∏—á–∏–∏ –ø–æ–º–µ—Ç–∫–∏ –≤ –ø–∏—Å—å–º–µ –º–µ–Ω–µ–¥–∂–µ—Ä–∞.
                    <div class="urgent-note">
                        <span class="alert-icon">üö®</span>
                        –í –ø–∏—Å—å–º–µ <span class="highlight-alert">–û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û</span> —É–∫–∞–∑—ã–≤–∞—Ç—å –ø—Ä–∏—á–∏–Ω—É —Å—Ä–æ—á–Ω–æ—Å—Ç–∏!
                    </div>
                </div>
            </div>
            
            <div class="timing-note">
                <div class="timing-icon">üìÖ</div>
                <div class="timing-text">
                    <strong>–°—Ä–æ–∫ –æ–±—Ä–∞–±–æ—Ç–∫–∏:</strong> 2 —Ä–∞–±–æ—á–∏—Ö –¥–Ω—è —Å –¥–∞—Ç—ã –≤–∑—è—Ç–∏—è —Ñ–∞–π–ª–∞ –≤ —Ä–∞–±–æ—Ç—É
                </div>
            </div>
        </div>
    </div>
</div>
                
            </div>
        </div>
    </div>
    
    <div class="container">
        <header>
            <h1><i class="fas fa-chart-pie"></i> –ó–∞–≥—Ä—É–∑–∫–∞ –Ω–æ–≤—ã—Ö —Ç–æ–≤–∞—Ä–æ–≤ –Ω–∞ —Å–∞–π—Ç</h1>
            <div class="subtitle">–û—á–µ—Ä–µ–¥—å –∑–∞–≥—Ä—É–∑–∫–∏ —Ç–æ–≤–∞—Ä–æ–≤</div>
            <div class="data-source-info">
                <i class="fas fa-database"></i> –ò—Å—Ç–æ—á–Ω–∏–∫ –¥–∞–Ω–Ω—ã—Ö: 
                <a href="https://docs.google.com/spreadsheets/d/1vCZQgzBPv8uahr8ckRI1f-TA_QS6Afz2B9NP_ZMj6ek/edit" 
                   target="_blank" style="color: #17a2b8; font-weight: 600;">
                   –¢–∞–±–ª–∏—Ü–∞ —Ä–∞–±–æ—á–∏—Ö –≥—Ä—É–ø–ø
                </a>
            </div>
            
            <div class="header-buttons">
                <button onclick="openModal()" class="btn-rules">
                    <i class="fas fa-info-circle"></i> –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Å–∏—Å—Ç–µ–º–µ
                </button>
            </div>
        </header>
        
        <div class="content">
            <div id="warningMessage" class="warning" style="display: none;">
                <i class="fas fa-exclamation-triangle"></i> <span id="warningText"></span>
            </div>
            
            <div id="errorMessage" class="error" style="display: none;">
                <i class="fas fa-exclamation-circle"></i> <span id="errorText"></span>
            </div>
            
            <div id="loading" class="loading">
                <i class="fas fa-spinner fa-spin fa-2x"></i>
                <p style="margin-top: 15px;">–ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö...</p>
                <p id="loadingDetails" style="font-size: 0.9em; color: #888; margin-top: 5px;"></p>
            </div>
            
            <div id="statsSection" style="display: none;">
                <div class="products-summary">
                    <div class="summary-card important">
                        <div class="summary-label">
                            <i class="fas fa-user-tie"></i> –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –Ω–æ–≤—ã—Ö —Ç–æ–≤–∞—Ä–æ–≤ –º–µ–Ω–µ–¥–∂–µ—Ä–æ–≤
                        </div>
                        <div class="summary-number" id="managerProductsToAdd">0</div>
                        <div class="summary-subtitle">–°—É–º–º–∞ —Ç–æ–≤–∞—Ä–æ–≤ –≤ —Å—Ç–∞—Ç—É—Å–µ "–í —Ä–∞–±–æ—Ç–µ" –∏ "–î–æ—Å—Ç—É–ø–Ω–æ" —Å –ª–∏—Å—Ç–∞ "üë• –†–∞–±–æ—á–∏–µ –≥—Ä—É–ø–ø—ã –ö–ê–ú" (GID: 1367779997)</div>
                    </div>
                    
                    <div class="summary-card important-2">
                        <div class="summary-label">
                            <i class="fas fa-file-alt"></i> –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –Ω–æ–≤—ã—Ö —Ç–æ–≤–∞—Ä–æ–≤ –∫–æ–Ω—Ç–µ–Ω—Ç–∞
                        </div>
                        <div class="summary-number" id="contentProductsToAdd">0</div>
                        <div class="summary-subtitle">–°—É–º–º–∞ —Ç–æ–≤–∞—Ä–æ–≤ –≤ —Å—Ç–∞—Ç—É—Å–µ "–í —Ä–∞–±–æ—Ç–µ" –∏ "–î–æ—Å—Ç—É–ø–Ω–æ" —Å –ª–∏—Å—Ç–∞ "–†–∞–±–æ—á–∏–µ –≥—Ä—É–ø–ø—ã –∫–æ–Ω—Ç–µ–Ω—Ç–∞" (GID: 33531424)</div>
                    </div>
                    
                    <div class="summary-card important-3">
                        <div class="summary-label">
                            <i class="fas fa-check-circle"></i> –î–æ–±–∞–≤–ª–µ–Ω–æ –≤ —Ç–µ–∫—É—â–µ–º –º–µ—Å—è—Ü–µ
                        </div>
                        <div class="summary-number" id="productsAddedThisMonth">0</div>
                        <div class="summary-subtitle">–°—É–º–º–∞ —Ç–æ–≤–∞—Ä–æ–≤ —Å–æ —Å—Ç–∞—Ç—É—Å–æ–º "–ó–∞–≤–µ—Ä—à–µ–Ω–æ" –∏–∑ –æ–±–æ–∏—Ö –ª–∏—Å—Ç–æ–≤ –≤ —Ç–µ–∫—É—â–µ–º –º–µ—Å—è—Ü–µ</div>
                    </div>
                </div>
                
                <div class="files-table-container">
                    <h2 class="section-title">
                        <i class="fas fa-user-tie"></i> –ó–∞–≥—Ä—É–∑–∫–∞ –∞—Å—Å–æ—Ä—Ç–∏–º–µ–Ω—Ç–∞ –æ—Ç –º–µ–Ω–µ–¥–∂–µ—Ä–∞ (üë• –†–∞–±–æ—á–∏–µ –≥—Ä—É–ø–ø—ã –ö–ê–ú)
                    </h2>
                    <div class="data-source-info">
                        <i class="fas fa-info-circle"></i> –ò—Å—Ç–æ—á–Ω–∏–∫: 
                        <a href="https://docs.google.com/spreadsheets/d/1vCZQgzBPv8uahr8ckRI1f-TA_QS6Afz2B9NP_ZMj6ek/edit?gid=1367779997" 
                           target="_blank" style="color: #17a2b8;">
                           –õ–∏—Å—Ç "üë• –†–∞–±–æ—á–∏–µ –≥—Ä—É–ø–ø—ã –ö–ê–ú" (GID: 1367779997)
                        </a>
                        | –¢–æ–ª—å–∫–æ —Å—Ç–∞—Ç—É—Å—ã "–í —Ä–∞–±–æ—Ç–µ" –∏ "–î–æ—Å—Ç—É–ø–Ω–æ"
                    </div>
                    
                    <table class="files-table">
                        <thead>
                            <tr>
                                <th><i class="fas fa-file"></i> –ù–∞–∑–≤–∞–Ω–∏–µ —Ñ–∞–π–ª–∞</th>
                                <th><i class="fas fa-boxes"></i> –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç–æ–≤–∞—Ä–æ–≤</th>
                                <th><i class="fas fa-calendar-plus"></i> –î–∞—Ç–∞ –≤–∑—è—Ç–∏—è</th>
                                <th><i class="fas fa-calendar-check"></i> –î–∞—Ç–∞ –ø—Ä–∏—Ö–æ–¥–∞ –æ—Ç –º–µ–Ω–µ–¥–∂–µ—Ä–∞</th>
                                <th><i class="fas fa-info-circle"></i> –°—Ç–∞—Ç—É—Å –≥—Ä—É–ø–ø—ã</th>
                                <th><i class="fas fa-clock"></i> –î–Ω–µ–π –Ω–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ</th>
                                <th><i class="fas fa-exclamation-triangle"></i> –°—Ä–æ—á–Ω–æ—Å—Ç—å</th>
                            </tr>
                        </thead>
                        <tbody id="managerFilesTableBody">
                        </tbody>
                    </table>
                </div>
                
                <div class="files-table-container">
                    <h2 class="section-title">
                        <i class="fas fa-file-alt"></i> –ó–∞–≥—Ä—É–∑–∫–∞ –∞—Å—Å–æ—Ä—Ç–∏–º–µ–Ω—Ç–∞ –∫–æ–Ω—Ç–µ–Ω—Ç–∞
                    </h2>
                    <div class="data-source-info">
                        <i class="fas fa-info-circle"></i> –ò—Å—Ç–æ—á–Ω–∏–∫: 
                        <a href="https://docs.google.com/spreadsheets/d/1vCZQgzBPv8uahr8ckRI1f-TA_QS6Afz2B9NP_ZMj6ek/edit?gid=33531424" 
                           target="_blank" style="color: #17a2b8;">
                           –õ–∏—Å—Ç "–†–∞–±–æ—á–∏–µ –≥—Ä—É–ø–ø—ã –∫–æ–Ω—Ç–µ–Ω—Ç–∞" (GID: 33531424)
                        </a>
                        | –¢–æ–ª—å–∫–æ —Å—Ç–∞—Ç—É—Å—ã "–í —Ä–∞–±–æ—Ç–µ" –∏ "–î–æ—Å—Ç—É–ø–Ω–æ"
                    </div>
                    
                    <table class="files-table">
                        <thead>
                            <tr>
                                <th><i class="fas fa-file"></i> –ù–∞–∑–≤–∞–Ω–∏–µ —Ñ–∞–π–ª–∞</th>
                                <th><i class="fas fa-boxes"></i> –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç–æ–≤–∞—Ä–æ–≤</th>
                                <th><i class="fas fa-calendar-plus"></i> –î–∞—Ç–∞ –≤–∑—è—Ç–∏—è</th>
                                <th><i class="fas fa-info-circle"></i> –°—Ç–∞—Ç—É—Å –≥—Ä—É–ø–ø—ã</th>
                                <th><i class="fas fa-clock"></i> –î–Ω–µ–π –Ω–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ</th>
                                <th><i class="fas fa-exclamation-triangle"></i> –°—Ä–æ—á–Ω–æ—Å—Ç—å</th>
                            </tr>
                        </thead>
                        <tbody id="contentFilesTableBody">
                        </tbody>
                    </table>
                </div>
                
                <!-- –°—Ç–æ–ª–±—á–∞—Ç–∞—è –¥–∏–∞–≥—Ä–∞–º–º–∞ –ø–æ –º–µ—Å—è—Ü–∞–º -->
                <div class="chart-container">
                    <h2 class="chart-title">
                        <i class="fas fa-chart-bar"></i> –ó–∞–≤–µ—Ä—à–µ–Ω–Ω—ã–µ —Ç–æ–≤–∞—Ä—ã –ø–æ –º–µ—Å—è—Ü–∞–º
                    </h2>
                    <div class="data-source-info">
                        <i class="fas fa-info-circle"></i> –°—É–º–º–∞ —Ç–æ–≤–∞—Ä–æ–≤ —Å–æ —Å—Ç–∞—Ç—É—Å–æ–º "–ó–∞–≤–µ—Ä—à–µ–Ω–æ" –∏–∑ –æ–±–æ–∏—Ö –ª–∏—Å—Ç–æ–≤, —Å–≥—Ä—É–ø–ø–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –ø–æ –º–µ—Å—è—Ü–∞–º
                    </div>
                    
                    <div class="chart-controls">
                        <button class="chart-btn active" onclick="changeChartType('monthly')" id="btnMonthly">
                            <i class="fas fa-calendar-alt"></i> –ü–æ –º–µ—Å—è—Ü–∞–º
                        </button>
                        <button class="chart-btn" onclick="changeChartType('quarterly')" id="btnQuarterly">
                            <i class="fas fa-chart-line"></i> –ü–æ –∫–≤–∞—Ä—Ç–∞–ª–∞–º
                        </button>
                        <button class="chart-btn" onclick="changeChartType('yearly')" id="btnYearly">
                            <i class="fas fa-chart-area"></i> –ü–æ –≥–æ–¥–∞–º
                        </button>
                    </div>
                    
                    <div class="chart-wrapper">
                        <canvas id="monthlyChart"></canvas>
                        <div id="noDataMessage" class="no-data-message" style="display: none;">
                            <i class="fas fa-chart-line" style="font-size: 3em; color: #ccc; margin-bottom: 15px;"></i>
                            <p>–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –æ –∑–∞–≤–µ—Ä—à–µ–Ω–Ω—ã—Ö —Ç–æ–≤–∞—Ä–∞—Ö</p>
                        </div>
                    </div>
                    
                    <div class="chart-stats">
                        <div class="stat-item">
                            <div class="stat-value" id="statTotal">0</div>
                            <div class="stat-label">–í—Å–µ–≥–æ –∑–∞–≤–µ—Ä—à–µ–Ω–æ</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-value" id="statAvg">0</div>
                            <div class="stat-label">–°—Ä–µ–¥–Ω–µ–µ –≤ –º–µ—Å—è—Ü</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-value" id="statMax">0</div>
                            <div class="stat-label">–ú–∞–∫—Å–∏–º—É–º –≤ –º–µ—Å—è—Ü</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-value" id="statCurrent">0</div>
                            <div class="stat-label">–¢–µ–∫—É—â–∏–π –º–µ—Å—è—Ü</div>
                        </div>
                    </div>
                </div>
                
                <div class="buttons">
                    <button onclick="loadPublicData()" class="btn btn-success">
                        <i class="fas fa-sync-alt"></i> –û–±–Ω–æ–≤–∏—Ç—å –¥–∞–Ω–Ω—ã–µ
                    </button>
                </div>
                
                <div class="last-update-info">
                    <i class="fas fa-clock"></i> –ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ: <span id="lastUpdateTime">-</span>
                </div>
            </div>
        </div>
    </div>

    <script>
        // –ö–û–ù–°–¢–ê–ù–¢–´ –î–õ–Ø –¢–ê–ë–õ–ò–¶–´
        const SPREADSHEET_ID = '1vCZQgzBPv8uahr8ckRI1f-TA_QS6Afz2B9NP_ZMj6ek'; // –û—Å–Ω–æ–≤–Ω–æ–π ID —Ç–∞–±–ª–∏—Ü—ã
        const PUBLIC_SPREADSHEET_ID = '2PACX-1vT2AYh3Iqgf07HInfdc3bQwE_L3AweAonhdE7LlJlJtBHo_5rx3WVko0Pdm5eGjCvmcjTOWja8nP20O'; // –ü—É–±–ª–∏—á–Ω—ã–π ID
        
        // GID –ª–∏—Å—Ç–æ–≤
        const MANAGER_SHEET_GID = '1367779997';    // üë• –†–∞–±–æ—á–∏–µ –≥—Ä—É–ø–ø—ã –ö–ê–ú
        const CONTENT_SHEET_GID = '33531424';      // –†–∞–±–æ—á–∏–µ –≥—Ä—É–ø–ø—ã –∫–æ–Ω—Ç–µ–Ω—Ç–∞
        
        // –ì–ª–æ–±–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–ª—è –¥–∞–Ω–Ω—ã—Ö
        let managerProductsToAdd = 0;
        let contentProductsToAdd = 0;
        let productsAddedThisMonth = 0;
        let managerFilesForProcessing = [];
        let contentFilesForProcessing = [];
        
        // –î–∞–Ω–Ω—ã–µ –¥–ª—è –¥–∏–∞–≥—Ä–∞–º–º—ã
        let monthlyCompletedData = {};
        let chart = null;
        let currentChartType = 'monthly'; // 'monthly', 'quarterly', 'yearly'
        
        // –¶–≤–µ—Ç–∞ –¥–ª—è –¥–∏–∞–≥—Ä–∞–º–º—ã
        const chartColors = {
            primary: '#FF8C00',
            secondary: '#36A2EB',
            success: '#4BC0C0',
            warning: '#FFCE56',
            danger: '#FF6384',
            info: '#9966FF',
            light: '#C9CBCF'
        };
        
        // –û—Ç–ª–∞–¥–æ—á–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è
        let debugLog = [];
        
        // –§—É–Ω–∫—Ü–∏–∏ –¥–ª—è –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞
        function openModal() {
            document.getElementById('infoModal').style.display = 'block';
            document.body.style.overflow = 'hidden'; // –ó–∞–ø—Ä–µ—â–∞–µ–º –ø—Ä–æ–∫—Ä—É—Ç–∫—É —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        }
        
        function closeModal() {
            document.getElementById('infoModal').style.display = 'none';
            document.body.style.overflow = 'auto'; // –í–æ–∑–≤—Ä–∞—â–∞–µ–º –ø—Ä–æ–∫—Ä—É—Ç–∫—É —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        }
        
        // –ó–∞–∫—Ä—ã—Ç–∏–µ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ –ø—Ä–∏ –∫–ª–∏–∫–µ –≤–Ω–µ –µ–≥–æ
        window.onclick = function(event) {
            const modal = document.getElementById('infoModal');
            if (event.target == modal) {
                closeModal();
            }
        }
        
        // –ó–∞–∫—Ä—ã—Ç–∏–µ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ –∫–ª–∞–≤–∏—à–µ–π ESC
        document.addEventListener('keydown', function(event) {
            if (event.key === 'Escape') {
                closeModal();
            }
        });
        
        function logDebug(message, data = null) {
            const timestamp = new Date().toLocaleTimeString();
            let logEntry = `[${timestamp}] ${message}`;
            
            if (data) {
                try {
                    if (typeof data === 'object' && data !== null) {
                        const simplifiedData = {};
                        for (const key in data) {
                            if (typeof data[key] === 'string' && data[key].length > 100) {
                                simplifiedData[key] = data[key].substring(0, 100) + '...';
                            } else {
                                simplifiedData[key] = data[key];
                            }
                        }
                        logEntry += `: ${JSON.stringify(simplifiedData, null, 2)}`;
                    } else {
                        logEntry += `: ${data}`;
                    }
                } catch (e) {
                    logEntry += `: [–û—à–∏–±–∫–∞ –≤—ã–≤–æ–¥–∞ –¥–∞–Ω–Ω—ã—Ö: ${e.message}]`;
                }
            }
            
            debugLog.push(logEntry);
            console.log(logEntry);
        }
        
        function updateLoadingDetails(text) {
            const loadingDetails = document.getElementById('loadingDetails');
            if (loadingDetails) {
                loadingDetails.textContent = text;
            }
        }
        
        function updateLastUpdateTime() {
            const now = new Date();
            const timeString = now.toLocaleTimeString('ru-RU');
            const dateString = now.toLocaleDateString('ru-RU');
            document.getElementById('lastUpdateTime').textContent = `${dateString} ${timeString}`;
        }
        
        // –ò–∑–º–µ–Ω–µ–Ω–∏–µ —Ç–∏–ø–∞ –¥–∏–∞–≥—Ä–∞–º–º—ã
        function changeChartType(type) {
            currentChartType = type;
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –∞–∫—Ç–∏–≤–Ω—É—é –∫–Ω–æ–ø–∫—É
            document.getElementById('btnMonthly').classList.remove('active');
            document.getElementById('btnQuarterly').classList.remove('active');
            document.getElementById('btnYearly').classList.remove('active');
            document.getElementById('btn' + type.charAt(0).toUpperCase() + type.slice(1)).classList.add('active');
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –¥–∏–∞–≥—Ä–∞–º–º—É
            updateChart();
        }
        
        // –í—ã—á–∏—Å–ª–µ–Ω–∏–µ –¥–Ω–µ–π –Ω–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ
        function calculateDaysToAdd(productsCount) {
            if (productsCount <= 0) return 0;
            // –û–∫—Ä—É–≥–ª—è–µ–º –≤–≤–µ—Ä—Ö –¥–æ —Ü–µ–ª–æ–≥–æ —á–∏—Å–ª–∞ –¥–Ω–µ–π
            return Math.ceil(productsCount / 50);
        }
        
        // –ü–æ–ª—É—á–µ–Ω–∏–µ –∫–ª–∞—Å—Å–∞ –¥–ª—è –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–∞ –¥–Ω–µ–π
        function getDaysClass(days) {
            if (days >= 10) return 'days-high';
            if (days >= 5) return 'days-medium';
            return 'days-low';
        }
        
        // –û–°–ù–û–í–ù–ê–Ø –§–£–ù–ö–¶–ò–Ø –ó–ê–ì–†–£–ó–ö–ò
        async function loadPublicData() {
            const loading = document.getElementById('loading');
            const statsSection = document.getElementById('statsSection');
            const warningMessage = document.getElementById('warningMessage');
            const errorMessage = document.getElementById('errorMessage');
            
            loading.style.display = 'block';
            statsSection.style.display = 'none';
            warningMessage.style.display = 'none';
            errorMessage.style.display = 'none';
            
            debugLog = [];
            logDebug('–ù–∞—á–∏–Ω–∞–µ–º –∑–∞–≥—Ä—É–∑–∫—É –¥–∞–Ω–Ω—ã—Ö —á–µ—Ä–µ–∑ –ø—É–±–ª–∏—á–Ω—ã–π –¥–æ—Å—Ç—É–ø');
            updateLoadingDetails('–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∫ –∑–∞–≥—Ä—É–∑–∫–µ...');
            
            try {
                // –°–±—Ä–æ—Å –¥–∞–Ω–Ω—ã—Ö
                managerProductsToAdd = 0;
                contentProductsToAdd = 0;
                productsAddedThisMonth = 0;
                managerFilesForProcessing = [];
                contentFilesForProcessing = [];
                monthlyCompletedData = {};
                
                // –ü—Ä–æ–±—É–µ–º –∑–∞–≥—Ä—É–∑–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –º–µ–Ω–µ–¥–∂–µ—Ä–æ–≤
                updateLoadingDetails('–ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –º–µ–Ω–µ–¥–∂–µ—Ä–æ–≤...');
                logDebug('–ü—Ä–æ–±—É–µ–º –∑–∞–≥—Ä—É–∑–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –º–µ–Ω–µ–¥–∂–µ—Ä–æ–≤');
                
                const managerData = await loadSheetData('manager');
                
                if (managerData && managerData.length > 1) {
                    logDebug('–î–∞–Ω–Ω—ã–µ –º–µ–Ω–µ–¥–∂–µ—Ä–æ–≤ –ø–æ–ª—É—á–µ–Ω—ã —É—Å–ø–µ—à–Ω–æ', { 
                        rows: managerData.length,
                        sampleData: managerData.slice(0, 2)
                    });
                    processData(managerData, 'manager');
                } else {
                    logDebug('–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –º–µ–Ω–µ–¥–∂–µ—Ä–æ–≤ –∏–ª–∏ —Ç–æ–ª—å–∫–æ –∑–∞–≥–æ–ª–æ–≤–∫–∏');
                    warningMessage.innerHTML += '<br><i class="fas fa-exclamation-circle"></i> –ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –º–µ–Ω–µ–¥–∂–µ—Ä–æ–≤ –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏.';
                }
                
                // –ü—Ä–æ–±—É–µ–º –∑–∞–≥—Ä—É–∑–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –∫–æ–Ω—Ç–µ–Ω—Ç–∞
                updateLoadingDetails('–ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –∫–æ–Ω—Ç–µ–Ω—Ç–∞...');
                logDebug('–ü—Ä–æ–±—É–µ–º –∑–∞–≥—Ä—É–∑–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –∫–æ–Ω—Ç–µ–Ω—Ç–∞');
                
                const contentData = await loadSheetData('content');
                
                if (contentData && contentData.length > 1) {
                    logDebug('–î–∞–Ω–Ω—ã–µ –∫–æ–Ω—Ç–µ–Ω—Ç–∞ –ø–æ–ª—É—á–µ–Ω—ã —É—Å–ø–µ—à–Ω–æ', { 
                        rows: contentData.length,
                        sampleData: contentData.slice(0, 2)
                    });
                    processData(contentData, 'content');
                } else {
                    logDebug('–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –∫–æ–Ω—Ç–µ–Ω—Ç–∞ –∏–ª–∏ —Ç–æ–ª—å–∫–æ –∑–∞–≥–æ–ª–æ–≤–∫–∏');
                    warningMessage.innerHTML += '<br><i class="fas fa-exclamation-circle"></i> –ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –∫–æ–Ω—Ç–µ–Ω—Ç–∞ –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏.';
                }
                
                // –û–±–Ω–æ–≤–ª—è–µ–º –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ
                updateDisplay();
                updateLastUpdateTime();
                
                // –°–æ–∑–¥–∞–µ–º –∏–ª–∏ –æ–±–Ω–æ–≤–ª—è–µ–º –¥–∏–∞–≥—Ä–∞–º–º—É
                updateChart();
                
                loading.style.display = 'none';
                statsSection.style.display = 'block';
                updateLoadingDetails('');
                
                if (managerFilesForProcessing.length > 0 || contentFilesForProcessing.length > 0 || Object.keys(monthlyCompletedData).length > 0) {
                    warningMessage.style.display = 'block';
                    warningMessage.style.backgroundColor = '#d4edda';
                    warningMessage.style.color = '#155724';
                    warningMessage.style.borderLeftColor = '#c3e6cb';
                    warningMessage.innerHTML = '<i class="fas fa-check-circle"></i> –î–∞–Ω–Ω—ã–µ —É—Å–ø–µ—à–Ω–æ –∑–∞–≥—Ä—É–∂–µ–Ω—ã!';
                    
                    logDebug('–ó–∞–≥—Ä—É–∑–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞ —É—Å–ø–µ—à–Ω–æ', {
                        managerFiles: managerFilesForProcessing.length,
                        contentFiles: contentFilesForProcessing.length,
                        managerProducts: managerProductsToAdd,
                        contentProducts: contentProductsToAdd,
                        completedThisMonth: productsAddedThisMonth,
                        monthlyData: Object.keys(monthlyCompletedData).length
                    });
                } else {
                    warningMessage.style.display = 'block';
                    warningMessage.innerHTML = '<i class="fas fa-exclamation-triangle"></i> –ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å –¥–∞–Ω–Ω—ã–µ. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç—É.';
                }
                
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏:', error);
                logDebug('–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –æ—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏', { 
                    error: error.message
                });
                
                loading.style.display = 'none';
                statsSection.style.display = 'block';
                errorMessage.style.display = 'block';
                document.getElementById('errorText').textContent = `–û—à–∏–±–∫–∞: ${error.message}. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –æ–±–Ω–æ–≤–∏—Ç—å –¥–∞–Ω–Ω—ã–µ.`;
            }
        }
        
        // –£–ù–ò–í–ï–†–°–ê–õ–¨–ù–ê–Ø –§–£–ù–ö–¶–ò–Ø –ó–ê–ì–†–£–ó–ö–ò –î–ê–ù–ù–´–•
        async function loadSheetData(source) {
            const gid = source === 'manager' ? MANAGER_SHEET_GID : CONTENT_SHEET_GID;
            
            const urls = [
                `https://docs.google.com/spreadsheets/d/e/${PUBLIC_SPREADSHEET_ID}/pub?gid=${gid}&single=true&output=csv`,
                `https://docs.google.com/spreadsheets/d/${SPREADSHEET_ID}/export?format=csv&gid=${gid}`,
                `https://docs.google.com/spreadsheets/d/${SPREADSHEET_ID}/pub?gid=${gid}&single=true&output=csv`,
                `https://docs.google.com/spreadsheets/d/${SPREADSHEET_ID}/gviz/tq?tqx=out:csv&gid=${gid}`,
            ];
            
            for (let i = 0; i < urls.length; i++) {
                const url = urls[i];
                try {
                    updateLoadingDetails(`–ó–∞–≥—Ä—É–∑–∫–∞ ${source} (–º–µ—Ç–æ–¥ ${i+1}/${urls.length})...`);
                    
                    const timestamp = new Date().getTime();
                    const finalUrl = `${url}${url.includes('?') ? '&' : '?'}_=${timestamp}`;
                    
                    const response = await fetch(finalUrl);
                    
                    if (!response.ok) continue;
                    
                    const text = await response.text();
                    
                    if (!text || text.trim() === '') continue;
                    
                    if (text.includes('<!DOCTYPE') || text.includes('<html')) continue;
                    
                    const rows = parseCSV(text);
                    
                    if (rows.length > 0) return rows;
                    
                } catch (error) {
                    // –ü—Ä–æ–¥–æ–ª–∂–∞–µ–º –ø—Ä–æ–±–æ–≤–∞—Ç—å —Å–ª–µ–¥—É—é—â–∏–µ URL
                }
            }
            
            logDebug(`–í—Å–µ –º–µ—Ç–æ–¥—ã –Ω–µ —Å—Ä–∞–±–æ—Ç–∞–ª–∏ –¥–ª—è ${source}`);
            return [];
        }
        
        // –ü–∞—Ä—Å–∏–Ω–≥ CSV
        function parseCSV(csvText) {
            if (csvText.includes('google.visualization.Query.setResponse')) {
                try {
                    const jsonStart = csvText.indexOf('{');
                    const jsonEnd = csvText.lastIndexOf('}') + 1;
                    const jsonText = csvText.substring(jsonStart, jsonEnd);
                    const data = JSON.parse(jsonText);
                    
                    const rows = [];
                    if (data.table && data.table.cols && data.table.rows) {
                        const headers = data.table.cols.map(col => col.label || '');
                        rows.push(headers);
                        
                        data.table.rows.forEach(row => {
                            const rowData = row.c.map(cell => cell ? cell.v || '' : '');
                            rows.push(rowData);
                        });
                    }
                    return rows;
                } catch (error) {
                    // –ï—Å–ª–∏ –Ω–µ –ø–æ–ª—É—á–∏–ª–æ—Å—å —Ä–∞—Å–ø–∞—Ä—Å–∏—Ç—å JSON, –ø—Ä–æ–¥–æ–ª–∂–∞–µ–º –∫–∞–∫ –æ–±—ã—á–Ω—ã–π CSV
                }
            }
            
            const rows = [];
            let currentRow = [];
            let currentField = '';
            let inQuotes = false;
            
            for (let i = 0; i < csvText.length; i++) {
                const char = csvText[i];
                const nextChar = csvText[i + 1];
                
                if (char === '"') {
                    if (inQuotes && nextChar === '"') {
                        currentField += '"';
                        i++;
                    } else {
                        inQuotes = !inQuotes;
                    }
                } else if (char === ',' && !inQuotes) {
                    currentRow.push(currentField.trim());
                    currentField = '';
                } else if (char === '\n' && !inQuotes) {
                    currentRow.push(currentField.trim());
                    rows.push(currentRow);
                    currentRow = [];
                    currentField = '';
                } else if (char === '\r') {
                    continue;
                } else {
                    currentField += char;
                }
            }
            
            if (currentField !== '' || currentRow.length > 0) {
                currentRow.push(currentField.trim());
                rows.push(currentRow);
            }
            
            return rows;
        }
        
        // –û–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö
        function processData(rows, source) {
            if (rows.length < 2) return;
            
            const headers = rows[0];
            
            const indices = {
                status: findColumnIndex(headers, ['–°—Ç–∞—Ç—É—Å –≥—Ä—É–ø–ø—ã', '–°—Ç–∞—Ç—É—Å', '–°–æ—Å—Ç–æ—è–Ω–∏–µ', '–°—Ç–∞—Ç—É—Å –≥—Ä—É–ø–ø—ã', 'Status']),
                products: findColumnIndex(headers, ['–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç–æ–≤–∞—Ä–æ–≤', '–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ', '–¢–æ–≤–∞—Ä—ã', '–ö–æ–ª-–≤–æ —Ç–æ–≤–∞—Ä–æ–≤', 'Products', 'Count']),
                filename: findColumnIndex(headers, ['–ò–º—è —Ñ–∞–π–ª–∞', '–§–∞–π–ª', '–ù–∞–∑–≤–∞–Ω–∏–µ', '–ù–∞–∑–≤–∞–Ω–∏–µ —Ñ–∞–π–ª–∞', 'File', 'Filename']),
                date: findColumnIndex(headers, ['–î–∞—Ç–∞ –≤–∑—è—Ç–∏—è', '–î–∞—Ç–∞', '–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è', 'Date']),
                managerDate: findColumnIndex(headers, ['–î–∞—Ç–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è —Ñ–∞–π–ª–∞', '–î–∞—Ç–∞ –æ—Ç –º–µ–Ω–µ–¥–∂–µ—Ä–∞', '–î–∞—Ç–∞ –ø—Ä–∏—Ö–æ–¥–∞', '–î–∞—Ç–∞ –ø–æ–ª—É—á–µ–Ω–∏—è']),
                urgency: findColumnIndex(headers, ['–°—Ä–æ—á–Ω–æ—Å—Ç—å', '–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç', '–í–∞–∂–Ω–æ—Å—Ç—å', 'Urgency', 'Priority']),
                completionDate: findColumnIndex(headers, ['–î–∞—Ç–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è —Ä–∞–±–æ—Ç—ã', '–î–∞—Ç–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è', '–î–∞—Ç–∞ –æ–∫–æ–Ω—á–∞–Ω–∏—è', 'Completion Date'])
            };
            
            // –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º —Å—Ç—Ä–æ–∫–∏
            for (let i = 1; i < rows.length; i++) {
                const row = rows[i];
                if (row.length === 0) continue;
                
                const analysis = analyzeRow(row, indices, source);
                
                if (analysis.filename && analysis.filename !== '') {
                    const daysToAdd = calculateDaysToAdd(analysis.productsCount);
                    const daysClass = getDaysClass(daysToAdd);
                    
                    const fileData = {
                        filename: analysis.filename,
                        productsCount: analysis.productsCount,
                        status: analysis.status,
                        statusType: analysis.statusType,
                        additionDate: analysis.additionDate,
                        managerAdditionDate: analysis.managerAdditionDate || '–ù–µ —É–∫–∞–∑–∞–Ω–∞',
                        urgency: analysis.urgency,
                        urgencyClass: getUrgencyClass(analysis.urgency),
                        daysToAdd: daysToAdd,
                        daysClass: daysClass,
                        source: source
                    };
                    
                    if (source === 'manager') {
                        if (analysis.statusType !== 'completed' && analysis.statusType !== 'unknown') {
                            managerFilesForProcessing.push(fileData);
                            managerProductsToAdd += analysis.productsCount;
                        }
                        // –°–æ–±–∏—Ä–∞–µ–º –¥–∞–Ω–Ω—ã–µ –ø–æ –º–µ—Å—è—Ü–∞–º –¥–ª—è –∑–∞–≤–µ—Ä—à–µ–Ω–Ω—ã—Ö —Ç–æ–≤–∞—Ä–æ–≤
                        if (analysis.statusType === 'completed' && analysis.completionMonthYear) {
                            addToMonthlyData(analysis.completionMonthYear, analysis.productsCount, analysis.completionYear, analysis.completionQuarter);
                            if (analysis.isCurrentMonth) {
                                productsAddedThisMonth += analysis.productsCount;
                            }
                        }
                    } else {
                        if (analysis.statusType !== 'completed' && analysis.statusType !== 'unknown') {
                            contentFilesForProcessing.push(fileData);
                            contentProductsToAdd += analysis.productsCount;
                        }
                        // –°–æ–±–∏—Ä–∞–µ–º –¥–∞–Ω–Ω—ã–µ –ø–æ –º–µ—Å—è—Ü–∞–º –¥–ª—è –∑–∞–≤–µ—Ä—à–µ–Ω–Ω—ã—Ö —Ç–æ–≤–∞—Ä–æ–≤
                        if (analysis.statusType === 'completed' && analysis.completionMonthYear) {
                            addToMonthlyData(analysis.completionMonthYear, analysis.productsCount, analysis.completionYear, analysis.completionQuarter);
                            if (analysis.isCurrentMonth) {
                                productsAddedThisMonth += analysis.productsCount;
                            }
                        }
                    }
                }
            }
        }
        
        // –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –≤ –º–µ—Å—è—á–Ω—É—é —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
        function addToMonthlyData(monthYear, count, year, quarter) {
            if (!monthlyCompletedData[monthYear]) {
                monthlyCompletedData[monthYear] = {
                    count: 0,
                    year: year,
                    quarter: quarter
                };
            }
            monthlyCompletedData[monthYear].count += count;
        }
        
        // –ü–æ–∏—Å–∫ –∏–Ω–¥–µ–∫—Å–∞ —Å—Ç–æ–ª–±—Ü–∞
        function findColumnIndex(headers, columnNames) {
            if (!headers) return -1;
            
            for (const columnName of columnNames) {
                const index = headers.findIndex(header => 
                    header && header.toString().toLowerCase().includes(columnName.toLowerCase())
                );
                if (index !== -1) return index;
            }
            
            return -1;
        }
        
        // –ê–Ω–∞–ª–∏–∑ —Å—Ç—Ä–æ–∫–∏
        function analyzeRow(row, indices, source) {
            const currentDate = new Date();
            const currentMonth = currentDate.getMonth();
            const currentYear = currentDate.getFullYear();
            
            const result = {
                status: '',
                statusType: 'unknown',
                productsCount: 0,
                filename: '',
                additionDate: '–ù–µ —É–∫–∞–∑–∞–Ω–∞',
                managerAdditionDate: '–ù–µ —É–∫–∞–∑–∞–Ω–∞',
                urgency: '',
                completionMonthYear: null,
                completionYear: null,
                completionQuarter: null,
                isCurrentMonth: false
            };
            
            // –°—Ç–∞—Ç—É—Å
            if (indices.status !== -1 && row[indices.status]) {
                result.status = row[indices.status].toString().trim();
                result.statusType = determineStatusType(result.status);
            }
            
            // –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç–æ–≤–∞—Ä–æ–≤
            if (indices.products !== -1 && row[indices.products]) {
                const str = row[indices.products].toString().trim();
                const num = parseFloat(str.replace(/[^\d.,]/g, '').replace(',', '.'));
                result.productsCount = isNaN(num) ? 0 : Math.round(num);
            }
            
            // –ò–º—è —Ñ–∞–π–ª–∞
            if (indices.filename !== -1 && row[indices.filename]) {
                result.filename = row[indices.filename].toString().trim();
            }
            
            // –î–∞—Ç–∞ –≤–∑—è—Ç–∏—è
            if (indices.date !== -1 && row[indices.date]) {
                const dateStr = row[indices.date].toString().trim();
                result.additionDate = formatDate(dateStr);
            }
            
            // –î–∞—Ç–∞ –ø—Ä–∏—Ö–æ–¥–∞ –æ—Ç –º–µ–Ω–µ–¥–∂–µ—Ä–∞ (—Ç–æ–ª—å–∫–æ –¥–ª—è –º–µ–Ω–µ–¥–∂–µ—Ä–æ–≤)
            if (source === 'manager' && indices.managerDate !== -1 && row[indices.managerDate]) {
                const managerDateStr = row[indices.managerDate].toString().trim();
                result.managerAdditionDate = formatDate(managerDateStr);
            }
            
            // –°—Ä–æ—á–Ω–æ—Å—Ç—å
            if (indices.urgency !== -1 && row[indices.urgency]) {
                result.urgency = row[indices.urgency].toString().trim();
                if (result.urgency === '') result.urgency = '–ù–µ —É–∫–∞–∑–∞–Ω–∞';
            }
            
            // –î–∞—Ç–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è
            if (indices.completionDate !== -1 && row[indices.completionDate]) {
                const dateStr = row[indices.completionDate].toString().trim();
                if (dateStr) {
                    try {
                        const dateOnly = dateStr.split(' ')[0];
                        const parts = dateOnly.split(/[\.\/-]/);
                        
                        if (parts.length === 3) {
                            const day = parseInt(parts[0], 10);
                            const month = parseInt(parts[1], 10) - 1;
                            const year = parts[2].length === 2 ? 2000 + parseInt(parts[2], 10) : parseInt(parts[2], 10);
                            
                            if (!isNaN(day) && !isNaN(month) && !isNaN(year)) {
                                // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ç–µ–∫—É—â–∏–π –º–µ—Å—è—Ü
                                result.isCurrentMonth = (month === currentMonth && year === currentYear);
                                
                                // –§–æ—Ä–º–∏—Ä—É–µ–º –∫–ª—é—á –¥–ª—è –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∏ –ø–æ –º–µ—Å—è—Ü–∞–º
                                const monthNames = [
                                    '–Ø–Ω–≤–∞—Ä—å', '–§–µ–≤—Ä–∞–ª—å', '–ú–∞—Ä—Ç', '–ê–ø—Ä–µ–ª—å', '–ú–∞–π', '–ò—é–Ω—å',
                                    '–ò—é–ª—å', '–ê–≤–≥—É—Å—Ç', '–°–µ–Ω—Ç—è–±—Ä—å', '–û–∫—Ç—è–±—Ä—å', '–ù–æ—è–±—Ä—å', '–î–µ–∫–∞–±—Ä—å'
                                ];
                                const monthName = monthNames[month];
                                result.completionMonthYear = `${monthName} ${year}`;
                                result.completionYear = year;
                                
                                // –û–ø—Ä–µ–¥–µ–ª—è–µ–º –∫–≤–∞—Ä—Ç–∞–ª
                                result.completionQuarter = Math.floor(month / 3) + 1;
                            }
                        }
                    } catch (e) {
                        // –ò–≥–Ω–æ—Ä–∏—Ä—É–µ–º –æ—à–∏–±–∫–∏ –ø–∞—Ä—Å–∏–Ω–≥–∞ –¥–∞—Ç—ã
                    }
                }
            }
            
            return result;
        }
        
        // –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ç–∏–ø–∞ —Å—Ç–∞—Ç—É—Å–∞
        function determineStatusType(status) {
            if (!status) return 'unknown';
            
            const statusLower = status.toLowerCase();
            
            if (status.includes('‚úÖ') || status.includes('‚úî') || status.includes('‚úì') || 
                status.includes('‚òë') || status.includes('üéØ')) {
                return 'completed';
            }
            if (status.includes('üîÑ') || status.includes('‚öôÔ∏è') || status.includes('‚è≥') || 
                status.includes('üìä') || status.includes('üë®‚Äçüíª')) {
                return 'in_progress';
            }
            if (status.includes('üÜï') || status.includes('üìÑ') || status.includes('üìã') || 
                status.includes('üìÅ') || status.includes('üìÇ')) {
                return 'available';
            }
            
            if (statusLower.includes('–∑–∞–≤–µ—Ä—à') || statusLower.includes('–≤—ã–ø–æ–ª–Ω') || 
                statusLower.includes('–≥–æ—Ç–æ–≤') || statusLower.includes('—Å–¥–µ–ª–∞–Ω') ||
                statusLower.includes('done') || statusLower.includes('completed') ||
                statusLower.includes('–≥–æ—Ç–æ–≤–æ') || statusLower.includes('–∑–∞–∫—Ä—ã—Ç')) {
                return 'completed';
            } else if (statusLower.includes('–¥–æ—Å—Ç—É–ø') || statusLower.includes('–Ω–æ–≤') || 
                      statusLower.includes('–æ–∂–∏–¥–∞–Ω') || statusLower.includes('available') ||
                      statusLower.includes('–Ω–æ–≤–∞—è') || statusLower.includes('–æ–∂–∏–¥–∞–µ—Ç')) {
                return 'available';
            } else if (statusLower.includes('—Ä–∞–±–æ—Ç') || statusLower.includes('–≤ –ø—Ä–æ—Ü') || 
                      statusLower.includes('–æ–±—Ä–∞–±–æ—Ç') || statusLower.includes('in progress') ||
                      statusLower.includes('–≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è') || statusLower.includes('–∞–∫—Ç–∏–≤')) {
                return 'in_progress';
            }
            
            return 'unknown';
        }
        
        // –ö–ª–∞—Å—Å —Å—Ä–æ—á–Ω–æ—Å—Ç–∏
        function getUrgencyClass(urgencyText) {
            if (!urgencyText) return 'urgency-low';
            
            const urgencyLower = urgencyText.toLowerCase();
            if (urgencyLower.includes('–≤—ã—Å–æ–∫') || urgencyLower.includes('—Å—Ä–æ—á–Ω') || 
                urgencyLower.includes('urgent') || urgencyLower.includes('high') ||
                urgencyLower.includes('–∫—Ä–∏—Ç–∏—á') || urgencyLower.includes('–≤–∞–∂–Ω')) {
                return 'urgency-high';
            } else if (urgencyLower.includes('—Å–µ—Ä–µ–¥') || urgencyLower.includes('medium') || 
                      urgencyLower.includes('norm') || urgencyLower.includes('–æ–±—ã—á')) {
                return 'urgency-medium';
            } else {
                return 'urgency-low';
            }
        }
        
        // –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–∞—Ç—ã
        function formatDate(dateString) {
            if (!dateString || dateString.trim() === '') {
                return '–ù–µ —É–∫–∞–∑–∞–Ω–∞';
            }
            
            try {
                const dateStr = dateString.trim();
                const parts = dateStr.split(/[\.\/-]/);
                if (parts.length >= 3) {
                    const day = parseInt(parts[0], 10);
                    const month = parseInt(parts[1], 10) - 1;
                    const year = parts[2].length === 2 ? 2000 + parseInt(parts[2], 10) : parseInt(parts[2], 10);
                    
                    if (!isNaN(day) && !isNaN(month) && !isNaN(year)) {
                        const date = new Date(year, month, day);
                        return date.toLocaleDateString('ru-RU');
                    }
                }
                
                const parsedDate = new Date(dateStr);
                if (!isNaN(parsedDate.getTime())) {
                    return parsedDate.toLocaleDateString('ru-RU');
                }
                
                return dateStr;
            } catch (e) {
                return dateString;
            }
        }
        
        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è
        function updateDisplay() {
            document.getElementById('managerProductsToAdd').textContent = managerProductsToAdd;
            document.getElementById('contentProductsToAdd').textContent = contentProductsToAdd;
            document.getElementById('productsAddedThisMonth').textContent = productsAddedThisMonth;
            
            updateManagerTable();
            updateContentTable();
        }
        
        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–∞–±–ª–∏—Ü—ã –º–µ–Ω–µ–¥–∂–µ—Ä–æ–≤
        function updateManagerTable() {
            const tableBody = document.getElementById('managerFilesTableBody');
            tableBody.innerHTML = '';
            
            if (managerFilesForProcessing.length === 0) {
                tableBody.innerHTML = `
                    <tr>
                        <td colspan="7" style="text-align: center; padding: 40px; color: #666;">
                            <i class="fas fa-info-circle"></i> –ù–µ—Ç —Ñ–∞–π–ª–æ–≤ –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –º–µ–Ω–µ–¥–∂–µ—Ä–æ–≤
                        </td>
                    </tr>
                `;
                return;
            }
            
            managerFilesForProcessing.forEach(file => {
                const statusClass = `status-${file.statusType.replace('_', '-')}`;
                const statusText = getStatusText(file.statusType);
                const urgencyClass = file.urgencyClass || 'urgency-low';
                const urgencyText = file.urgency || '–ù–µ —É–∫–∞–∑–∞–Ω–∞';
                const daysText = file.daysToAdd > 0 ? `${file.daysToAdd} –¥–Ω.` : '0 –¥–Ω.';
                
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td><strong>${file.filename}</strong></td>
                    <td><span class="highlight">${file.productsCount}</span></td>
                    <td class="date-cell">${file.additionDate}</td>
                    <td class="date-cell">${file.managerAdditionDate}</td>
                    <td><span class="file-status ${statusClass}">${statusText}</span></td>
                    <td><span class="file-status ${file.daysClass}">${daysText}</span></td>
                    <td><span class="file-status ${urgencyClass}">${urgencyText}</span></td>
                `;
                tableBody.appendChild(row);
            });
        }
        
        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–∞–±–ª–∏—Ü—ã –∫–æ–Ω—Ç–µ–Ω—Ç–∞
        function updateContentTable() {
            const tableBody = document.getElementById('contentFilesTableBody');
            tableBody.innerHTML = '';
            
            if (contentFilesForProcessing.length === 0) {
                tableBody.innerHTML = `
                    <tr>
                        <td colspan="6" style="text-align: center; padding: 40px; color: #666;">
                            <i class="fas fa-info-circle"></i> –ù–µ—Ç —Ñ–∞–π–ª–æ–≤ –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∫–æ–Ω—Ç–µ–Ω—Ç–∞
                        </td>
                    </tr>
                `;
                return;
            }
            
            contentFilesForProcessing.forEach(file => {
                const statusClass = `status-${file.statusType.replace('_', '-')}`;
                const statusText = getStatusText(file.statusType);
                const urgencyClass = file.urgencyClass || 'urgency-low';
                const urgencyText = file.urgency || '–ù–µ —É–∫–∞–∑–∞–Ω–∞';
                const daysText = file.daysToAdd > 0 ? `${file.daysToAdd} –¥–Ω.` : '0 –¥–Ω.';
                
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td><strong>${file.filename}</strong></td>
                    <td><span class="highlight">${file.productsCount}</span></td>
                    <td class="date-cell">${file.additionDate}</td>
                    <td><span class="file-status ${statusClass}">${statusText}</span></td>
                    <td><span class="file-status ${file.daysClass}">${daysText}</span></td>
                    <td><span class="file-status ${urgencyClass}">${urgencyText}</span></td>
                `;
                tableBody.appendChild(row);
            });
        }
        
        // –¢–µ–∫—Å—Ç —Å—Ç–∞—Ç—É—Å–∞
        function getStatusText(statusType) {
            switch(statusType) {
                case 'in_progress': return 'üîÑ –í —Ä–∞–±–æ—Ç–µ';
                case 'available': return 'üÜï –î–æ—Å—Ç—É–ø–Ω–æ';
                case 'completed': return '‚úÖ –ó–∞–≤–µ—Ä—à–µ–Ω–æ';
                default: return '‚ùì –ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ';
            }
        }
        
        // –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –¥–∏–∞–≥—Ä–∞–º–º—ã
        function prepareChartData() {
            const entries = Object.entries(monthlyCompletedData);
            
            if (entries.length === 0) {
                return { labels: [], data: [] };
            }
            
            // –°–æ—Ä—Ç–∏—Ä—É–µ–º –ø–æ –≥–æ–¥—É –∏ –º–µ—Å—è—Ü—É
            entries.sort((a, b) => {
                const [monthYearA] = a;
                const [monthYearB] = b;
                const [monthA, yearA] = monthYearA.split(' ');
                const [monthB, yearB] = monthYearB.split(' ');
                
                const monthOrder = {
                    '–Ø–Ω–≤–∞—Ä—å': 1, '–§–µ–≤—Ä–∞–ª—å': 2, '–ú–∞—Ä—Ç': 3, '–ê–ø—Ä–µ–ª—å': 4,
                    '–ú–∞–π': 5, '–ò—é–Ω—å': 6, '–ò—é–ª—å': 7, '–ê–≤–≥—É—Å—Ç': 8,
                    '–°–µ–Ω—Ç—è–±—Ä—å': 9, '–û–∫—Ç—è–±—Ä—å': 10, '–ù–æ—è–±—Ä—å': 11, '–î–µ–∫–∞–±—Ä—å': 12
                };
                
                if (parseInt(yearA) !== parseInt(yearB)) {
                    return parseInt(yearA) - parseInt(yearB);
                }
                return monthOrder[monthA] - monthOrder[monthB];
            });
            
            let labels = [];
            let data = [];
            
            if (currentChartType === 'monthly') {
                // –ü–æ –º–µ—Å—è—Ü–∞–º
                labels = entries.map(entry => entry[0]);
                data = entries.map(entry => entry[1].count);
            } else if (currentChartType === 'quarterly') {
                // –ü–æ –∫–≤–∞—Ä—Ç–∞–ª–∞–º
                const quarterlyData = {};
                entries.forEach(([monthYear, info]) => {
                    const quarterKey = `Q${info.quarter} ${info.year}`;
                    if (!quarterlyData[quarterKey]) {
                        quarterlyData[quarterKey] = 0;
                    }
                    quarterlyData[quarterKey] += info.count;
                });
                
                // –°–æ—Ä—Ç–∏—Ä—É–µ–º –∫–≤–∞—Ä—Ç–∞–ª—ã
                const quarterEntries = Object.entries(quarterlyData).sort((a, b) => {
                    const [quarterA, yearA] = a[0].split(' ');
                    const [quarterB, yearB] = b[0].split(' ');
                    
                    if (parseInt(yearA) !== parseInt(yearB)) {
                        return parseInt(yearA) - parseInt(yearB);
                    }
                    return parseInt(quarterA.substring(1)) - parseInt(quarterB.substring(1));
                });
                
                labels = quarterEntries.map(entry => entry[0]);
                data = quarterEntries.map(entry => entry[1]);
            } else if (currentChartType === 'yearly') {
                // –ü–æ –≥–æ–¥–∞–º
                const yearlyData = {};
                entries.forEach(([monthYear, info]) => {
                    const yearKey = `${info.year}`;
                    if (!yearlyData[yearKey]) {
                        yearlyData[yearKey] = 0;
                    }
                    yearlyData[yearKey] += info.count;
                });
                
                // –°–æ—Ä—Ç–∏—Ä—É–µ–º –≥–æ–¥—ã
                const yearEntries = Object.entries(yearlyData).sort((a, b) => 
                    parseInt(a[0]) - parseInt(b[0])
                );
                
                labels = yearEntries.map(entry => entry[0]);
                data = yearEntries.map(entry => entry[1]);
            }
            
            return { labels, data };
        }
        
        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
        function updateStats(chartData) {
            const { labels, data } = chartData;
            
            if (data.length === 0) {
                document.getElementById('statTotal').textContent = '0';
                document.getElementById('statAvg').textContent = '0';
                document.getElementById('statMax').textContent = '0';
                document.getElementById('statCurrent').textContent = '0';
                return;
            }
            
            const total = data.reduce((sum, value) => sum + value, 0);
            const avg = Math.round(total / data.length);
            const max = Math.max(...data);
            
            // –¢–µ–∫—É—â–∏–π –º–µ—Å—è—Ü
            const currentDate = new Date();
            const currentMonth = currentDate.getMonth();
            const currentYear = currentDate.getFullYear();
            const monthNames = ['–Ø–Ω–≤–∞—Ä—å', '–§–µ–≤—Ä–∞–ª—å', '–ú–∞—Ä—Ç', '–ê–ø—Ä–µ–ª—å', '–ú–∞–π', '–ò—é–Ω—å',
                               '–ò—é–ª—å', '–ê–≤–≥—É—Å—Ç', '–°–µ–Ω—Ç—è–±—Ä—å', '–û–∫—Ç—è–±—Ä—å', '–ù–æ—è–±—Ä—å', '–î–µ–∫–∞–±—Ä—å'];
            const currentMonthYear = `${monthNames[currentMonth]} ${currentYear}`;
            const currentMonthData = monthlyCompletedData[currentMonthYear] ? monthlyCompletedData[currentMonthYear].count : 0;
            
            document.getElementById('statTotal').textContent = total;
            document.getElementById('statAvg').textContent = avg;
            document.getElementById('statMax').textContent = max;
            document.getElementById('statCurrent').textContent = currentMonthData;
        }
        
        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–∏–∞–≥—Ä–∞–º–º—ã
        function updateChart() {
            const ctx = document.getElementById('monthlyChart').getContext('2d');
            const noDataMessage = document.getElementById('noDataMessage');
            
            // –ü–æ–¥–≥–æ—Ç–∞–≤–ª–∏–≤–∞–µ–º –¥–∞–Ω–Ω—ã–µ
            const chartData = prepareChartData();
            const { labels, data } = chartData;
            
            // –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
            updateStats(chartData);
            
            // –ï—Å–ª–∏ –Ω–µ—Ç –¥–∞–Ω–Ω—ã—Ö
            if (labels.length === 0 || data.length === 0) {
                noDataMessage.style.display = 'block';
                if (chart) {
                    chart.destroy();
                    chart = null;
                }
                return;
            }
            
            noDataMessage.style.display = 'none';
            
            // –°–æ–∑–¥–∞–µ–º –≥—Ä–∞–¥–∏–µ–Ω—Ç –¥–ª—è —Å—Ç–æ–ª–±—Ü–æ–≤
            const gradient = ctx.createLinearGradient(0, 0, 0, 400);
            gradient.addColorStop(0, chartColors.primary);
            gradient.addColorStop(1, '#FFB500');
            
            // –°–æ–∑–¥–∞–µ–º –∏–ª–∏ –æ–±–Ω–æ–≤–ª—è–µ–º –¥–∏–∞–≥—Ä–∞–º–º—É
            if (chart) {
                chart.data.labels = labels;
                chart.data.datasets[0].data = data;
                chart.update();
            } else {
                chart = new Chart(ctx, {
                    type: 'bar',
                    data: {
                        labels: labels,
                        datasets: [{
                            label: '–ó–∞–≤–µ—Ä—à–µ–Ω–Ω—ã–µ —Ç–æ–≤–∞—Ä—ã',
                            data: data,
                            backgroundColor: gradient,
                            borderColor: chartColors.primary,
                            borderWidth: 1,
                            borderRadius: 5,
                            hoverBackgroundColor: chartColors.secondary
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: {
                                display: false
                            },
                            tooltip: {
                                callbacks: {
                                    label: function(context) {
                                        return `–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ: ${context.raw}`;
                                    }
                                }
                            }
                        },
                        scales: {
                            y: {
                                beginAtZero: true,
                                ticks: {
                                    callback: function(value) {
                                        return value.toLocaleString('ru-RU');
                                    }
                                },
                                title: {
                                    display: true,
                                    text: '–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç–æ–≤–∞—Ä–æ–≤'
                                }
                            },
                            x: {
                                ticks: {
                                    maxRotation: 45,
                                    minRotation: 45
                                }
                            }
                        }
                    }
                });
            }
        }
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ –ø—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        document.addEventListener('DOMContentLoaded', function() {
            logDebug('–°—Ç—Ä–∞–Ω–∏—Ü–∞ –∑–∞–≥—Ä—É–∂–µ–Ω–∞, –Ω–∞—á–∏–Ω–∞–µ–º –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫—É—é –∑–∞–≥—Ä—É–∑–∫—É –¥–∞–Ω–Ω—ã—Ö...');
            loadPublicData();
        });
    </script>
</body>
</html>
